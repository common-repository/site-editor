window.sedApp=window.sedApp||{},function(a,b){var c,d,e,f,g=Array.prototype.slice;d=function(a,b){var c=f(this,a,b);return c.extend=this.extend,c},e=function(){},f=function(a,c,d){var f;return f=c&&c.hasOwnProperty("constructor")?c.constructor:function(){var b=a.apply(this,arguments);return b},b.extend(f,a),e.prototype=a.prototype,f.prototype=new e,c&&b.extend(f.prototype,c),d&&b.extend(f,d),f.prototype.constructor=f,f.__super__=a.prototype,f},c={},c.Class=function(a,d,e){var f,g=arguments;return a&&d&&c.Class.applicator===a&&(g=d,b.extend(this,e||{})),f=this,this.instance&&(f=function(){return f.instance.apply(f,arguments)},b.extend(f,this)),f.initialize.apply(f,g),f},c.Class.applicator={},c.Class.prototype.initialize=function(){},c.Class.prototype.extended=function(a){for(var b=this;"undefined"!=typeof b.constructor;){if(b.constructor===a)return!0;if("undefined"==typeof b.constructor.__super__)return!1;b=b.constructor.__super__}return!1},c.Class.extend=d,c.Events={trigger:function(a){return this.topics&&this.topics[a]&&this.topics[a].fireWith(this,g.call(arguments,1)),this},bind:function(a){return this.topics=this.topics||{},this.topics[a]=this.topics[a]||b.Callbacks(),this.topics[a].add.apply(this.topics[a],g.call(arguments,1)),this},unbind:function(a){return this.topics&&this.topics[a]&&this.topics[a].remove.apply(this.topics[a],g.call(arguments,1)),this}},c.Value=c.Class.extend({initialize:function(a,c){this._value=a,this.callbacks=b.Callbacks(),this._dirty=!1,b.extend(this,c||{}),this.set=b.proxy(this.set,this)},instance:function(){return arguments.length?this.set.apply(this,arguments):this.get()},get:function(){return this._value},set:function(a){var c=this._value;return a=this._setter.apply(this,arguments),a=this.validate(a),null===a||_.isEqual(c,a)&&b.inArray(this.stype,["module","style-editor","force-refresh"])==-1?this:(this._value=a,this._dirty=!0,this.callbacks.fireWith(this,[a,c]),this)},_setter:function(a){return a},setter:function(a){var b=this.get();return this._setter=a,this._value=null,this.set(b),this},resetSetter:function(){return this._setter=this.constructor.prototype._setter,this.set(this.get()),this},validate:function(a){return a},bind:function(){return this.callbacks.add.apply(this.callbacks,arguments),this},unbind:function(){return this.callbacks.remove.apply(this.callbacks,arguments),this},link:function(){var a=this.set;return b.each(arguments,function(){this.bind(a)}),this},unlink:function(){var a=this.set;return b.each(arguments,function(){this.unbind(a)}),this},sync:function(){var a=this;return b.each(arguments,function(){a.link(this),this.link(a)}),this},unsync:function(){var a=this;return b.each(arguments,function(){a.unlink(this),this.unlink(a)}),this}}),c.Values=c.Class.extend({defaultConstructor:c.Value,initialize:function(a){b.extend(this,a||{}),this._value={},this._deferreds={}},instance:function(a){return 1===arguments.length?this.value(a):this.when.apply(this,arguments)},value:function(a){return this._value[a]},has:function(a){return"undefined"!=typeof this._value[a]},add:function(a,b){return this.has(a)?this.value(a):(this._value[a]=b,b.parent=this,b.extended(c.Value)&&b.bind(this._change),this.trigger("add",b),this._deferreds[a]&&this._deferreds[a].resolve(),this._value[a])},create:function(a){return this.add(a,new this.defaultConstructor(c.Class.applicator,g.call(arguments,1)))},each:function(a,c){c="undefined"==typeof c?this:c,b.each(this._value,function(b,d){a.call(c,d,b)})},remove:function(a){var b;this.has(a)&&(b=this.value(a),this.trigger("remove",b),b.extended(c.Value)&&b.unbind(this._change),delete b.parent),delete this._value[a],delete this._deferreds[a]},when:function(){var a=this,c=g.call(arguments),d=b.Deferred();return b.isFunction(c[c.length-1])&&d.done(c.pop()),b.when.apply(b,b.map(c,function(c){if(!a.has(c))return a._deferreds[c]=a._deferreds[c]||b.Deferred()})).done(function(){var e=b.map(c,function(b){return a(b)});return e.length!==c.length?void a.when.apply(a,c).done(function(){d.resolveWith(a,e)}):void d.resolveWith(a,e)}),d.promise()},_change:function(){this.parent.trigger("change",this)}}),b.extend(c.Values.prototype,c.Events),c.ensure=function(a){return"string"==typeof a?b(a):a},c.Element=c.Value.extend({initialize:function(a,d){var e,f,g,h=this,i=c.Element.synchronizer.html;this.element=c.ensure(a),this.events="",this.element.is("input, select, textarea")&&(this.events+="change",i=c.Element.synchronizer.val,this.element.is("input")?(e=this.element.prop("type"),c.Element.synchronizer[e]&&(i=c.Element.synchronizer[e]),"text"===e||"password"===e?this.events+=" keyup":"range"===e&&(this.events+=" input propertychange")):this.element.is("textarea")&&(this.events+=" keyup")),c.Value.prototype.initialize.call(this,null,b.extend(d||{},i)),this._value=this.get(),f=this.update,g=this.refresh,this.update=function(a){a!==g.call(h)&&f.apply(this,arguments)},this.refresh=function(){h.set(g.call(h))},this.bind(this.update),this.element.bind(this.events,this.refresh)},find:function(a){return b(a,this.element)},refresh:function(){},update:function(){}}),c.Element.synchronizer={},b.each(["html","val"],function(a,b){c.Element.synchronizer[b]={update:function(a){this.element[b](a)},refresh:function(){return this.element[b]()}}}),c.Element.synchronizer.checkbox={update:function(a){this.element.prop("checked",a)},refresh:function(){return this.element.prop("checked")}},c.Element.synchronizer.radio={update:function(a){this.element.filter(function(){return this.value===a}).prop("checked",!0)},refresh:function(){return this.element.filter(":checked").val()}},b.support.postMessage=!!window.postMessage,c.Messenger=c.Class.extend({add:function(a,b,d){return this[a]=new c.Value(b,d)},initialize:function(a,c){var d=window.parent==window?null:window.parent;b.extend(this,c||{}),this.add("channel",a.channel),this.add("url",a.url||""),this.add("origin",this.url()).link(this.url).setter(function(a){return a.replace(/([^:]+:\/\/[^\/]+).*/,"$1")}),this.add("targetWindow",null),this.targetWindow.set=function(a){var b=this._value;return a=this._setter.apply(this,arguments),a=this.validate(a),null===a||b===a?this:(this._value=a,this._dirty=!0,this.callbacks.fireWith(this,[a,b]),this)},this.targetWindow(a.targetWindow||d),this.receive=b.proxy(this.receive,this),this.receive.guid=b.guid++,b(window).on("message",this.receive)},destroy:function(){b(window).off("message",this.receive)},receive:function(a){var b;a=a.originalEvent,this.targetWindow()&&(this.origin()&&a.origin!==this.origin()||"string"==typeof a.data&&"{"===a.data[0]&&(b=JSON.parse(a.data),b&&b.id&&"undefined"!=typeof b.data&&((b.channel||this.channel())&&this.channel()!==b.channel||this.trigger(b.id,b.data))))},send:function(a,b){var c;b="undefined"==typeof b?null:b,this.url()&&this.targetWindow()&&(c={id:a,data:b},this.channel()&&(c.channel=this.channel()),this.targetWindow().postMessage(JSON.stringify(c),this.origin()))}}),b.extend(c.Messenger.prototype,c.Events),c=b.extend(new c.Values,c),c.get=function(){var a={};return this.each(function(b,c){a[c]=b.get()}),a},c.Filters=c.Class.extend({initialize:function(){this.topics={}},add:function(a,b,c){_.isUndefined(this.topics[a])&&(this.topics[a]=[]),this.topics[a].push({callback:b,priority:c||10,type:"add"})},remove:function(a,b,c){_.isUndefined(this.topics[a])&&(this.topics[a]=[]),this.topics[a].push({callback:b,priority:c||10,type:"remove"})},render:function(a,c){if(_.isUndefined(this.topics[a]))return c.length>0&&c[0];var d,e=_.sortBy(this.topics[a],"priority");return _.each(e,b.proxy(function(a){a.callback;d=a.callback.apply(a,c)},this)),d}}),c.filters=new c.Filters,c.applyFilters=function(a){return c.filters.render(a,g.call(arguments,1))},c.addFilter=function(a,b,d){c.filters.add(a,b,d)},c.log=function(){var a=arguments,c=!1;0!=a.length&&c!==!1&&(console&&console.log?console.log.apply(console,a):(b.each(a,function(a,b){alert(b)}),alert(msg)))},c.currentSedElementId="",c.fn={},c.fn.ucfirst=function(a){a+="";var b=a.charAt(0).toUpperCase();return b+a.substr(1)},c.fn.urldecode=function(a){return decodeURIComponent((a+"").replace(/\+/g,"%20"))},c.fn.urlencode=function(a){return a=(a+"").toString(),encodeURIComponent(a).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},c.fn.rawurldecode=function(a){return decodeURIComponent(a+"")},c.fn.rawurlencode=function(a){return a=(a+"").toString(),encodeURIComponent(a).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")},a.editor=c}(sedApp,jQuery),function(a,b){var c=sedApp.editor;c.SiteEditorShortcode=c.Class.extend({findChildren:function(a,c){var d=this,e=[];return b.each(a,function(f,g){g.parent_id==c&&(e.push(g),e=b.merge(e,d.findChildren(a,g.id)))}),e},findParentOf:function(a,c){var d=[];return b.each(a,function(a,b){b.parent_id==c&&d.push(b)}),d},index:function(a,b){return _.findIndex(b,{id:a})},findModelsById:function(a,b){var c=_.findWhere(a,{id:b});if(_.isUndefined(c)||!c)return[];var d=this.findChildren(a,b)||[];return d.unshift(c),d},clone:function(a){var c=_.map(a,function(a){var c=b.extend(!0,{},a);return c});return c},getModelsType:function(){var a=b("#website")[0].contentWindow.jQuery('[sed_model_id="'+c.currentTargetElementId+'"]'),d=a.parents(".sed-pb-post-container:first");return d.data("contentType")},readyPattern:function(a){var b=this.clone(a);return b=this.modifyModelsIds(b),_.isUndefined(b[0].theme_id)||delete b[0].theme_id,_.isUndefined(b[0].is_customize)||delete b[0].is_customize,b},modifyModelsIds:function(a){var b=this;return this.Ids={},a=_.map(a,function(a){var d=c.pageBuilder.getNewId();return b.Ids[a.id]=d,a.id=d,a.attrs.sed_model_id=d,a}),a=_.map(a,function(a){return _.isUndefined(b.Ids[a.parent_id])||(a.parent_id=b.Ids[a.parent_id]),a})},getContentModel:function(a){var d=b("body").hasClass("siteeditor-app")?b('[sed_model_id="'+a+'"]'):b("#website")[0].contentWindow.jQuery('[sed_model_id="'+a+'"]'),e=d.parents(".sed-pb-post-container:first"),f=e.data("contentType"),g=e.data("postId");if("theme"==f)var h=c.pagesThemeContent[g];else var h=c.postsContent[g];return h},replaceModel:function(a,c){var d=this.getContentModel(a),e=this.index(a,d),f=this.findModelsById(d,a),g=f.length,h=b.merge([e,g],c);Array.prototype.splice.apply(d,h)},getShortcode:function(a){var b=this.getContentModel(a),c=_.findWhere(b,{id:a});return c},getAttrs:function(a,c){c=!(_.isUndefined(c)||c!==!0);var d=this.getShortcode(a);if(d){if(c===!1)return d.attrs;var e=this.getContentModel(a),f=_.findWhere(e,{tag:"content",parent_id:a});if(!f)return d.attrs;var g=b.extend(!0,{},d.attrs);return g.sed_shortcode_content=f.content,g}},getPatternScripts:function(a){var d=[];return _.each(a,function(a){_.isUndefined(c.shortcodes[a.tag])||(d=b.merge(d,c.shortcodesScripts[a.tag]||[]))}),d},getPatternModulesScripts:function(a){var b=[];return _.each(a,function(a){if(!_.isUndefined(c.shortcodes[a.tag])){var d=c.shortcodes[a.tag];!_.isUndefined(d.asModule)&&d.asModule&&(_.isUndefined(c.ModulesEditorJs[d.moduleName])||b.push(c.ModulesEditorJs[d.moduleName]))}}),b},getPatternStyles:function(a){var d=[];return _.each(a,function(a){_.isUndefined(c.shortcodes[a.tag])||(d=b.merge(d,c.shortcodesStyles[a.tag]||[]))}),d},getPatternTransport:function(a){var d="default";return b.each(a,function(a,b){if(!_.isUndefined(c.shortcodes[b.tag])){var e=c.pageBuilder.getModuleTransport(b.tag,"shortcode");if("ajax"==e)return d="ajax",!1}}),d},getPatternAttachmentIds:function(a){var d=[];return _.each(a,function(a){_.isUndefined(c.shortcodes[a.tag])||_.isUndefined(a.attrs)||_.isUndefined(c.shortcodes[a.tag].mediaAtts)||_.isEmpty(c.shortcodes[a.tag].mediaAtts)||_.each(c.shortcodes[a.tag].mediaAtts,function(c){if(!_.isUndefined(a.attrs[c])){var e=_.isString(a.attrs[c])&&a.attrs[c].indexOf(",")>-1?a.attrs[c].split(","):parseInt(b.trim(a.attrs[c]));b.isArray(e)?_.each(e,function(a){a=parseInt(b.trim(a)),d.push(a)}):e>0&&d.push(e)}})}),d=_.uniq(d)}}),c.sedShortcode=new c.SiteEditorShortcode}(sedApp,jQuery),function(a,b){var c=sedApp.editor,d=[],e=[];c.currentAjax=c.currentAjax||{},c.Ajax=c.Class.extend({initialize:function(a,d){if(this.options=b.extend(!0,{type:"POST",url:SEDAJAX.url,dataType:"html",data:{},success:function(){},error:function(){},always:function(){},beforeSend:function(){}},a||{}),this.success=this.options.success,this.error=this.options.error,delete this.options.success,delete this.options.error,this.options.hasOwnProperty("done")&&delete this.options.done,this.options.hasOwnProperty("fail")&&delete this.options.fail,(_.isUndefined(d.container)||_.isString(d.container)&&!d.container||0==d.container.length)&&(d.container="body"),this.container=d.container,_.isUndefined(this.options.loading)){var e,f,g=0==b("#tmpl-sed-ajax-loading").length?"sed-ajax-loading-tpl":"sed-ajax-loading",h=c.template(g);_.isUndefined(this.options.loadingType)?e={type:""}:(e={type:this.options.loadingType},delete this.options.loadingType),f=h(e),this.loading=b(f).appendTo(b(this.container))}else this.loading=this.options.loading,delete this.options.loading;this.errorElm=b(".sed-ajax-error",this.container),this.successElm=b(".sed-ajax-success",this.container),this.overlayElm=b(".sed-ajax-overlay",this.container),b.extend(this,d),this.render()},render:function(){var a,c=b.extend(this.options.data,{url:this.options.url}),f=JSON.stringify(c),g=!1,h=this;b.each(e,function(b,c){if(f===c)return g=!0,a=b,!1}),g!==!0||!_.isUndefined(this.repeatRequest)&&this.repeatRequest?(this.loading.show(),this.overlayElm.show(),this.request=b.ajax(this.options),this.request.done(function(){e.push(f),h.requestDone.apply(h,arguments)}),this.request.fail(function(){h.requestFail.apply(h,arguments)})):(this.response=d[a],this.response.success===!0?this.success():this.error())},requestDone:function(a,e,f){var g=this;return this.loading.hide(),this.overlayElm.hide(),"0"==a?c.hasOwnProperty("previewer")?(c.previewer.preview.iframe.hide(),void c.previewer.login().done(function(){g.render(),c.previewer.preview.iframe.show()})):(c.currentAjax=g,void c.preview.send("check_user_logged_out")):"-1"==a?c.hasOwnProperty("previewer")?void c.previewer.cheatin():void c.preview.send("check_cheaters"):"-2"==a?(g.errorElm.show(),void g.errorElm.html(c.I18n.invalid_data)):(g.errorElm.hide(),g.response=b.parseJSON(a),d.push(g.response),void(g.response.success===!0?g.success():g.error()))},requestFail:function(a,d,e){var f=this;this.loading.hide(),this.overlayElm.hide();var g="<p>"+c.I18n.please+'<a href="#" class="sed-ajax-try-again"><b>'+c.I18n.try_again+"</b></a></p>";0===a.textStatus?f.errorElm.html(c.I18n.disconnect):404==a.textStatus?f.errorElm.html(c.I18n.not_found):500==a.textStatus?f.errorElm.html(c.I18n.internal_error):"parsererror"===e?f.errorElm.html(c.I18n.parser_error):"timeout"===e?f.errorElm.html(c.I18n.timeout):"abort"===e?f.errorElm.html(c.I18n.abort):f.errorElm.html(c.I18n.uncaught+a.responseText);var h=b(g).appendTo(f.errorElm);h.on("click",function(){f.tryAgain()})},tryAgain:function(){this.render()}})}(sedApp,jQuery),function(a,b){var c=sedApp.editor,d=0;c.loadingScripts=[],c.loadingStyles=[],c.ModulesScriptsLoader=c.Class.extend({initialize:function(a,c){b.extend(this,c||{}),this.ready()},ready:function(){},_checkLoadedScript:function(a,d,e){if(b.isArray(a)){var f;f="js"==e?c.loadingScripts:c.loadingStyles,a=b.grep(a,function(a,c){return!(b.inArray(a[0],d)!=-1||b.inArray(a[0],f)!=-1||!a[0]||!a[1])})}return a},moduleScStLoad:function(a,d,e,f){f=f||"js";var g=this,h={},i=[];if(b.isArray(a)&&0!=a.length&&(a=g._checkLoadedScript(a,d,f),0!=a.length)){var j=function(a){if(b.isArray(a)){var c=[];b.each(a,function(a,d){b.inArray(d[0],c)==-1&&c.push(d[0])}),b.each(a,function(a,e){if(b.isArray(e[2])&&e[2].length>0){e[2]=b.grep(e[2],function(a,e){return(b.inArray(a,d)!=-1||b.inArray(a,c)!=-1)&&b.inArray(a,d)==-1})}})}return a};if(a=j(a),b.isArray(a)&&0!=a.length){var k=function(a){if(b.isArray(a)){var c=[];b.each(a,function(a,d){b.inArray(d[0],c)==-1&&c.push(d[0]);var e=c.indexOf(d[0]);b.isArray(d[2])&&d[2].length>0&&b.each(d[2],function(a,d){b.inArray(d,c)==-1&&(c.splice(e,0,d),e+=1)})})}return c};i=k(a),b.each(i,function(a,b){"js"==f?c.loadingScripts.push(b):c.loadingStyles.push(b),h[b]=0});var l=!1,m=function(){l===!1&&(c.Events.trigger("moduleLoadComplate"),e&&e(),l=!0)},n=0;g._loadQueue=function(){var c=!1,d=0;return b.each(h,function(a,b){if(d+=b,0==b)return c=!0,!1}),0==c&&d==2*h.length?(m(),void alert("complete")):void(0!=c&&b.each(i,function(c,d){for(var e,j=0;j<a.length;j++)if(a[j][0]==d){e=a[j];break}if(0==h[d])if(0!=c&&b.isArray(e[2])&&0!=e[2].length){var k=0;b.each(e[2],function(a,b){k+=h[b]}),k==2*e[2].length&&(h[d]=1,g.loadScript(e[1],function(){h[d]=2,g.loadDown(d,f),g._loadQueue(),n++,n==i.length&&m()},f,e[4]))}else h[d]=1,g.loadScript(e[1],function(){h[d]=2,g.loadDown(d,f),g._loadQueue(),n++,n==i.length&&m()},f,e[4])}))},g._loadQueue()}}},loadDown:function(a,d){if("js"==d){var e=b.inArray(a,c.loadingScripts);e>-1&&c.loadingScripts.splice(e,0)}else{var e=b.inArray(a,c.loadingStyles);e>-1&&c.loadingStyles.splice(e,0)}},loadScript:function(a,b,c,e){function f(){h&&(h.onreadystatechange=h.onload=h=null),"function"==typeof b&&b()}function g(){}var h,i;c=c||"js",i="sed_app_modules_scripts_"+c+d,d++,h="js"==c?document.createElement("script"):document.createElement("link"),h.id=i,h.type="js"==c?"text/javascript":"text/css","js"==c?h.src=a:(h.href=a,h.rel="stylesheet",h.media=e||"all"),"onreadystatechange"in h?h.onreadystatechange=function(){/loaded|complete/.test(h.readyState)&&f()}:h.onload=f,h.onerror=g,!e&&"js"==c||"css"==c?(document.getElementsByTagName("head")[0]||document.body).appendChild(h):document.body.appendChild(h)}})}(sedApp,jQuery),window.sedApp=window.sedApp||{},function(a,b){function c(){}c.prototype={init:function(){},hexToRgb:function(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return c?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null},componentToHex:function(a){var b=a.toString(16);return 1==b.length?"0"+b:b},rgbToHex:function(a){var b=this;a=a.replace("rgb(",""),a=a.replace(")",""),a=a.split(",");var c=parseInt(a[0]),d=parseInt(a[1]),e=parseInt(a[2]);return"#"+b.componentToHex(c)+b.componentToHex(d)+b.componentToHex(e)},addOpacityToRGB:function(a,b){return a=a.replace("rgb(",""),a=a.replace(")",""),a="rgba("+a+","+b+")"},gradient:function(a,b,c,d){var e=this;if(c.type)var f=c.type;else var f="linear";if(startHexColor=e.rgbToHex(a),endHexColor=e.rgbToHex(b),c.opacity){var g=c.opacity;g=g.split(","),a=e.addOpacityToRGB(a,g[0]),b=e.addOpacityToRGB(b,g[1])}else var g="";if(c.percent)var h=c.percent;else var h="0,100";switch(h=h.split(","),h[0]=h[0]+"%",h[1]=h[1]+"%",c.orientation){case"horizontal":var i="left",j="left top, right top",k="to right",l=1;break;case"vertical":var i="top",j="left top, right bottom",k="to bottom",l=0;break;case"diagonal-rb":var i="-45deg",j="left top, left bottom",k="135deg",l=1;break;case"diagonal-rt":var i="45deg",j="left bottom, right top",k="45deg",l=1;break;case"radial":var i="center, ellipse cover",j="center center, 0px, center center, 100%",k="ellipse at center",l=1;break;default:var i="top",j="left top, right bottom",k="to bottom",l=1}var m="-moz-"+f+"-gradient("+i+" , "+a+" "+h[0]+" , "+b+" "+h[1]+") !important; /* FF3.6+ */",n="-webkit-gradient("+f+" , "+j+" , color-stop("+h[0]+","+a+"),  color-stop("+h[1]+","+b+") ) !important; /* Chrome,Safari4+ */",o="-webkit-"+f+"-gradient("+i+" , "+a+" "+h[0]+" , "+b+" "+h[1]+") !important; /* Chrome10+,Safari5.1+ */",p="-o-"+f+"-gradient("+i+" , "+a+" "+h[0]+" , "+b+" "+h[1]+") !important; /* Opera 12+ */",q="-ms-"+f+"-gradient("+i+" , "+a+" "+h[0]+" , "+b+" "+h[1]+") !important; /* IE10+ */",r=f+"-gradient("+k+" , "+a+" "+h[0]+" , "+b+" "+h[1]+") !important; /* W3C */",s="progid:DXImageTransform.Microsoft.gradient( startColorstr='"+startHexColor+"', endColorstr='"+endHexColor+"',GradientType="+l+" ) !important; /* IE6-8 fallback on horizontal gradient */";d=d?'url("'+d+'") , ':"";var t="background: "+a+" "+d+" !important; /* Old browsers */background:"+d+m+"background:"+d+n+"background:"+d+o+"background:"+d+p+"background:"+d+q+"background:"+d+r+"-pie-background:"+d+r+"filter:"+s;return"firefox"==jQuery.browser.name&&(jQuery.browser.versionNumber<3||3==jQuery.browser.versionNumber&&jQuery.browser.versionX<6)&&alert(siteEditor.I18n.GRADIENT_FIREFOX_NOT_SUPPORT),"safari"==jQuery.browser.name&&jQuery.browser.versionNumber<4&&alert(siteEditor.I18n.GRADIENT_SAFARI_NOT_SUPPORT),"opera"==jQuery.browser.name&&jQuery.browser.versionNumber<12&&alert(siteEditor.I18n.GRADIENT_OPERA_NOT_SUPPORT),"msie"==jQuery.browser.name&&(9==jQuery.browser.versionNumber||jQuery.browser.versionNumber<6)&&alert(siteEditor.I18n.GRADIENT_MSIE_NOT_SUPPORT),t},gradientEndColor:function(a){var b=0;if(a.r<=200?b+=1:b-=1,a.g<=200?b+=1:b-=1,a.b<=200?b+=1:b-=1,b<0)var c=-55;else var c=55;var d=a.r>200&&b>0?255:a.r+c,e=a.g>200&&b>0?255:a.g+c,f=a.b>200&&b>0?255:a.b+c,g="rgb("+d+","+e+","+f+")";return g},setGradient:function(a,b,c){var d=this,e=tinycolor(a),f=d.gradientEndColor(e.toRgb()),g=e.toHexString();g=d.hexToRgb(g),g="rgb("+g.r+","+g.g+","+g.b+")";var h=d.gradient(g,f,b,c);return h},backgroundSize:function(a){if(Modernizr.backgroundsize)var b="-moz-background-size:"+a+" !important;",c="-o-background-size:"+a+" !important;",d="-webkit-background-size:"+a+" !important;",e="background-size:"+a+" !important;",f=b+c+d+e;else{"firefox"==jQuery.browser.name&&(jQuery.browser.versionNumber<3||3==jQuery.browser.versionNumber&&jQuery.browser.versionX<6)&&alert(siteEditor.I18n.BGSIZE_FIREFOX_NOT_SUPPORT),"safari"==jQuery.browser.name&&jQuery.browser.versionNumber<3&&alert(siteEditor.I18n.BGSIZE_SAFARI_NOT_SUPPORT),"opera"==jQuery.browser.name&&(jQuery.browser.versionNumber<9||9==jQuery.browser.versionNumber&&jQuery.browser.versionX<5)&&alert(siteEditor.I18n.BGSIZE_OPERA_NOT_SUPPORT),"msie"==jQuery.browser.name&&jQuery.browser.versionNumber<9&&alert(siteEditor.I18n.BGSIZE_MSIE_NOT_SUPPORT),"chrome"==jQuery.browser.name&&jQuery.browser.versionNumber<1&&alert(siteEditor.I18n.BGSIZE_MSIE_NOT_SUPPORT);var f=""}return f},backgroundColor:function(a){},transparency:function(a){opacity2=a/100;var b="zoom: 1 !important;-ms-filter: progid:DXImageTransform.Microsoft.Alpha(Opacity="+a+") !important;filter: alpha(opacity="+a+") !important;-moz-opacity: "+opacity2+" !important;-khtml-opacity: "+opacity2+" !important;opacity: "+opacity2+" !important;";return b},boxShadow:function(a){var b;"string"==typeof a?b=a:"object"==typeof a&&(a=jQuery.extend({HShadow:"1px",VShadow:"1px",blur:"",spread:"",color:"",inset:""},a),b=a.HShadow+" "+a.VShadow+" ",b+=a.blur?a.blur+" ":"",b+=a.spread?a.spread+" ":"",b+=a.color?a.color+" ":"",b+=a.inset?a.inset:"");var c="-webkit-box-shadow: "+b+" !important;-moz-box-shadow: "+b+" !important;box-shadow: "+b+" !important;behavior: url("+_sedAssetsUrls.base.js+"/PIE/PIE.htc);";return c},borderRadius:function(a){var b="-webkit-border-radius: "+a+" !important;-moz-border-radius: "+a+" !important;border-radius: "+a+" !important;behavior: url("+_sedAssetsUrls.base.js+"/PIE/PIE.htc);";return b},sedBorderRadius:function(a,b,c){var d;switch(b.toLowerCase()){case"tl":d="top-left";break;case"tr":d="top-right";break;case"bl":d="bottom-left";break;case"br":d="bottom-right"}c=_.isUndefined(c)?"px":c;var e="-webkit-border-"+d+"-radius: "+a+c+" !important;-moz-border-"+d+"-radius: "+a+c+" !important;border-"+d+"-radius: "+a+c+" !important;behavior: url("+_sedAssetsUrls.base.js+"/PIE/PIE.htc);";return e}},a.css=c}(sedApp,jQuery),function(a,b){var c=sedApp.editor;c.currentControl=c.currentControl||"",c.frontPageDisplayChange=!1,c.previewerActive=c.previewerActive||!1,c.Setting=c.Value.extend({initialize:function(a,b,d){c.Value.prototype.initialize.call(this,b,d),this.id=a,this.transport=this.transport||"refresh",this._dirty=d.dirty||!1,this.bind(this.preview)},preview:function(){this.previewer.trigger(this.id+"_update");var a=c.applyFilters("sedPreviewerTransportFilter",this.transport,this.id);switch(a){case"refresh":return c.Events.trigger("beforeRefreshPreviewer",this.id),this.previewer.refresh();case"postMessage":return this.previewer.send("setting",[this.id,this()])}}}),c.Control=c.Class.extend({defaultActiveArguments:{duration:"fast",completeCallback:b.noop},initialize:function(a,d){var e,f=this;this.params={},b.extend(this,d||{}),this.id=a,this.selector="#sed-app-control-"+a.replace(/\]/g,"").replace(/\[/g,"-"),this.container=b(this.selector),this.container.addClass("sed-container-control-element"),f.active=new c.Value((!0),{stype:"force-refresh"}),f.activeArgumentsQueue=[],e=b.map(this.params.settings,function(a){return a}),c.apply(c,e.concat(function(){var a;f.settings={};for(a in f.params.settings)f.settings[a]=c(f.params.settings[a]);f.setting=f.settings["default"]||null,f.ready()})),f.active.bind(function(a){var c=f.activeArgumentsQueue.shift();c=b.extend({},f.defaultActiveArguments,c),f.onChangeActive(a,c)})},onChangeActive:function(a,c){return c.unchanged?void(c.completeCallback&&c.completeCallback()):void(b.contains(document,this.container[0])?a?this.container.parents(".row_settings:first").slideDown(c.duration,c.completeCallback):this.container.parents(".row_settings:first").slideUp(c.duration,c.completeCallback):(this.container.toggle(a),c.completeCallback&&c.completeCallback()))},controlMod:function(a){var c,d=this.container,e=this.container.find(".sed-control-element"),f=d.find(">.sed-control-element-disable");if(a=0==arguments.length?1:a,0!=e.length)switch(c=e[0].nodeName.toLowerCase(),1==a?e.addClass("element-disabled"):e.removeClass("element-disabled"),c){case"input":case"select":case"button":1==a?e.attr("disabled","disabled"):e.removeAttr("disabled");break;case"img":break;default:0==f.length&&(f=b('<div class="sed-control-element-disable"></div>').appendTo(d)),1==a?f.show():f.hide()}},ready:function(){},update:function(){},dropdownInit:function(){var a=this,b=this.container.find(".dropdown-status"),c=this.params,d=!1,e=function(a){"string"==typeof a&&c.statuses&&c.statuses[a]?b.html(c.statuses[a]).show():b.hide()};this.container.on("click keydown",".dropdown",function(b){"keydown"===b.type&&13!==b.which||(b.preventDefault(),d||a.container.toggleClass("open"),a.container.hasClass("open")&&a.container.parent().parent().find("li.library-selected").focus(),d=!0,setTimeout(function(){d=!1},400))}),this.setting.bind(e),e(this.setting())}}),c.UploadControl=c.Control.extend({ready:function(){var a,d,e=this,f=this.container.find(".sed-uploader"),g=(f.attr("sed-style-element"),f.attr("id")),h=e.setting();d=e.mediaSettings.types.image.caption,this.uploader=this.uploader||{},e.params.extensions?this.uploader.filters={max_file_size:e.mediaSettings.params.max_upload_size+"mb",mime_types:[{title:d,extensions:e.params.extensions}]}:(a=e.mediaSettings.types.image.ext,a=a.join(","),this.uploader.filters={max_file_size:e.mediaSettings.params.max_upload_size+"mb",mime_types:[{title:d,extensions:a}]}),e.params.max_upload_size&&e.params.max_upload_size<=e.mediaSettings.max_upload_size&&(this.uploader.filters.max_file_size=e.params.max_upload_size+"mb"),e.params.media_group?this.uploader.url=SEDEXTBASE.url+"media/includes/upload.php?media_group="+e.params.media_group:this.uploader.url=SEDEXTBASE.url+"media/includes/upload.php",e.params.multi_selection?this.uploader.multi_selection=e.params.multi_selection:this.uploader.multi_selection=!1,f.seduploader(this.uploader),f.on("UploadComplete",function(a,d){var f=b("#"+g+"-items").find(".img-icon").attr("full-src");h[e.targetElement]=f,e.currentValue=f,e.previewer.currentElement=e.targetElement,e.setting.set(h),_.isUndefined(e.params.shortcode)||_.isUndefined(e.params.attr_name)||c.Events.trigger("afterControlValueRefresh",e.params.shortcode,f)})},update:function(a){var b=this;b.setting();a&&(b.targetElement=a)}}),c.LibraryControl=c.Control.extend({ready:function(){var a=this,c=this.container.find(".sed-library");this.imgLoaded=!1,c.on("click",function(c){var d=b(this);a.imgLoaded===!1&&(yepnope({load:_sedAssetsUrls.base.js+"/lazyload/js/jquery.bttrlazyloading.min.js",callback:function(a,b,c){d.next().find(".library-bg-img").bttrlazyloading({width:27,height:27})}}),a.imgLoaded=!0)}),this.getValue=function(a){return a.hasClass("no-image")?"":a.find("img").attr("full-src")},this.sedDropdownInit()},update:function(a){var b=this;b.setting();a&&(b.targetElement=a),b.dropdownUpdate()}}),c.ShowOnFrontControl=c.Control.extend({ready:function(){var a=this,d=(a.setting(),this.container.find(".sed-element-control"));this.element=d,0!=d.length&&(this.update(),d.on("change",function(d,e){var f=b(this).val(),g=!1;if("posts"==f){(parseInt(c("page_on_front")())>0&&c.isHome===!0||parseInt(c("page_for_posts")())>0&&c.isIndexBlog===!0||parseInt(c("page_for_posts")())>0&&c.isHome===!0&&0==parseInt(c("page_on_front")()))&&(g=!0),c("page_on_front").set(0),c("page_for_posts").set(0);var h=c.control.instance("page_on_front");h.update(0);var i=c.control.instance("page_for_posts");i.update(0),b("#sed-app-control-page_for_posts").find(".sed-element-control > option").show(),b("#sed-app-control-page_on_front").find(".sed-element-control > option").show()}else"page"==f&&(parseInt(c("page_on_front")())>0&&c.isHome===!0||parseInt(c("page_for_posts")())>0&&c.isIndexBlog===!0)&&(g=!0);a.setting.set(f),g===!0&&(c.frontPageDisplayChange=!0,c.previewer.refresh())}))},update:function(a){var b=this,c=b.setting();_.isUndefined(a)?attrValue=c:attrValue=a,this.element.filter(function(){return this.value===attrValue}).prop("checked",!0)}}),c.FrontPagePostsControl=c.Control.extend({ready:function(){var a=this,d=(a.setting(),this.container.find(".sed-element-control"));this.element=d,0!=d.length&&(this.update(),d.on("change",function(d,e){var f=b(this).val(),g=!1;if(a.setting.set(f),("page_on_front"==a.id&&parseInt(c("page_on_front")())>0&&c.isHome===!0||"page_for_posts"==a.id&&parseInt(c("page_for_posts")())>0&&c.isIndexBlog===!0||parseInt(c("page_for_posts")())>0&&c.isHome===!0&&0==parseInt(c("page_on_front")()))&&(g=!0),b("#sed-app-control-page_for_posts").find(".sed-element-control > option").show(),b("#sed-app-control-page_on_front").find(".sed-element-control > option").show(),"page_on_front"==a.id&&(b("#sed-app-control-page_for_posts").find(".sed-element-control > option").show(),f>0&&b("#sed-app-control-page_for_posts").find(".sed-element-control > option[value='"+f+"']").hide()),"page_for_posts"==a.id&&(b("#sed-app-control-page_on_front").find(".sed-element-control > option").show(),f>0&&b("#sed-app-control-page_on_front").find(".sed-element-control > option[value='"+f+"']").hide()),0==parseInt(c("page_on_front")())&&0==parseInt(c("page_for_posts")())){c("show_on_front").set("posts");var h=c.control.instance("show_on_front");h.update("posts"),b(".sed-app-control-dropdown-pages").hide()}g===!0&&(c.frontPageDisplayChange=!0,c.previewer.refresh())}))},update:function(a){var b=this,c=b.setting();_.isUndefined(a)?attrValue=c:attrValue=a,this.element.val(attrValue)}}),c.defaultConstructor=c.Setting,c.control=new c.Values({defaultConstructor:c.Control}),c.PreviewFrame=c.Messenger.extend({sensitivity:2e3,initialize:function(a,d){var e=b.Deferred();e.promise(this),this.container=a.container,this.signature=a.signature,b.extend(a,{channel:c.PreviewFrame.uuid()}),c.Messenger.prototype.initialize.call(this,a,d),this.add("previewUrl",a.previewUrl),this.query=b.extend(a.query||{},{customize_messenger_channel:this.channel()}),this.run(e)},run:function(a){var d=this,e=!1,f=!1;this._ready&&this.unbind("ready",this._ready),this._ready=function(){f=!0,e&&a.resolveWith(d)},this.bind("ready",this._ready),this.bind("ready",function(a){this.container.addClass("iframe-ready"),!a}),this.request=b.ajax(this.previewUrl(),{
type:"POST",data:this.query,xhrFields:{withCredentials:!0}}),this.request.fail(function(){a.rejectWith(d,["request failure"])}),this.request.done(function(g){var h,i=d.request.getResponseHeader("Location"),j=d.signature;return i&&i!==d.previewUrl()?void a.rejectWith(d,["redirect",i]):"0"===g?void d.login(a):(c.currentPreviewUrl=d.previewUrl(),"-1"===g?void a.rejectWith(d,["cheatin"]):(h=g.lastIndexOf(j),-1===h||h<g.lastIndexOf("</html>")?void a.rejectWith(d,["unsigned"]):(g=g.slice(0,h)+g.slice(h+j.length),d.iframe=b("<iframe />",{title:c.l10n.previewIframeTitle}).appendTo(d.container),c.settings.browser.mobileVersion?d.iframe.css({width:"767px",height:"100%"}):d.iframe.css({width:"100%",height:"100%"}),d.iframe.attr("id","website"),d.iframe.one("load",function(){e=!0,f?a.resolveWith(d):setTimeout(function(){a.rejectWith(d,["ready timeout"])},d.sensitivity)}),d.targetWindow(d.iframe[0].contentWindow),d.targetWindow().document.open(),d.targetWindow().document.write(g),void d.targetWindow().document.close())))})},login:function(a){var d,e=this;return d=function(){a.rejectWith(e,["logged out"])},this.triedLogin?d():void b.get(c.settings.url.ajax,{action:"logged-in"}).fail(d).done(function(f){var g;"1"!==f&&d(),g=b("<iframe />",{src:e.previewUrl(),title:c.l10n.previewIframeTitle}).hide(),g.appendTo(e.container),g.on("load",function(){e.triedLogin=!0,g.remove(),e.run(a)})})},destroy:function(){c.Messenger.prototype.destroy.call(this),this.request.abort(),this.iframe&&this.iframe.remove(),delete this.request,delete this.iframe,delete this.targetWindow}}),function(){var a=0;c.PreviewFrame.uuid=function(){return"preview-"+a++}}(),c.Previewer=c.Messenger.extend({refreshBuffer:250,initialize:function(a,d){var e=this,f=/^https?/;b.extend(this,d||{}),this.deferred={active:b.Deferred()},this.refresh=function(a){var b,c=a.refresh,d=function(){b=null,c.call(a)};return function(){if("number"!=typeof b){if(!a.loading)return d();a.abort()}clearTimeout(b),b=setTimeout(d,a.refreshBuffer)}}(this),this.container=c.ensure(a.container),this.allowedUrls=a.allowedUrls,this.signature=a.signature,a.url=window.location.href,c.Messenger.prototype.initialize.call(this,a),this.add("scheme",this.origin()).link(this.origin).setter(function(a){var b=a.match(f);return b?b[0]:""}),this.add("previewUrl",a.previewUrl).setter(function(a){var c;return/\/wp-admin(\/|$)/.test(a.replace(/[#?].*$/,""))?null:(b.each([a.replace(f,e.scheme()),a],function(a,d){if(b.each(e.allowedUrls,function(a,b){var e;if(b=b.replace(/\/+$/,""),e=d.replace(b,""),0===d.indexOf(b)&&/^([\/#?]|$)/.test(e))return c=d,!1}),c)return!1}),c?c:null)}),this.previewUrl.bind(this.refresh),this.scroll=0,this.bind("scroll",function(a){this.scroll=a}),this.bind("url",this.previewUrl)},query:function(){},abort:function(){this.loading&&(this.loading.destroy(),delete this.loading)},refresh:function(){var a=this;this.send("loading-initiated"),this.abort(),b("#sed_full_editor_loading").show(),c.Events.trigger("beforeRefresh"),this.loading=new c.PreviewFrame({url:this.url(),previewUrl:this.previewUrl(),query:this.query()||{},container:this.container,signature:this.signature}),this.loading.done(function(){b("#sed_full_editor_loading").hide(),c.previewer.trigger("beforeNewPreviewerActive"),this.bind("synced",function(){a.preview&&a.preview.destroy(),a.preview=this,delete a.loading,a.targetWindow(this.targetWindow()),a.channel(this.channel()),c.frontPageDisplayChange=!1,_.isUndefined(c.currentPreviewType)||"new"!=c.currentPreviewType||a.send("changePreviewType"),a.deferred.active.resolve(),a.send("active"),c.previewer.trigger("previewerActive"),c.previewerActive=!0}),this.send("sync",{scroll:a.scroll,settings:c.get()})}),this.loading.fail(function(c,d){b("#sed_full_editor_loading").hide(),a.send("loading-failed"),"redirect"===c&&d&&a.previewUrl(d),"logged out"===c&&(a.preview&&(a.preview.destroy(),delete a.preview),a.login().done(a.refresh)),"cheatin"===c&&a.cheatin()})},login:function(){var a,d,e,f=this;return this._login?this._login:(a=b.Deferred(),this._login=a.promise(),d=new c.Messenger({channel:"login",url:c.settings.url.login}),e=b("<iframe />",{src:c.settings.url.login,title:c.l10n.loginIframeTitle}).appendTo(this.container),d.targetWindow(e[0].contentWindow),d.bind("login",function(){var b=f.refreshNonces();b.always(function(){e.remove(),d.destroy(),delete f._login}),b.done(function(){a.resolve()}),b.fail(function(){f.cheatin(),a.reject()})}),this._login)},cheatin:function(){b(document.body).empty().addClass("cheatin").append("<h1>"+c.l10n.cheatin+"</h1><p>"+c.l10n.notAllowed+"</p>")},refreshNonces:function(){var a,d=b.Deferred();return d.promise(),a=c.wpAjax.send("sed_app_refresh_nonces",{data:{sed_app_editor:"on",theme:c.settings.theme.stylesheet},url:c.settings.url.ajax}),a.done(function(a){c.trigger("nonce-refresh",a),d.resolve()}),a.fail(function(){d.reject()}),d}}),c.controlConstructor={upload:c.UploadControl,library:c.LibraryControl},b(function(){if(c.settings=window._sedAppEditorSettings,c.settingsPanels=window._sedAppSettingsPanels,c.l10n=window._sedAppEditorControlsL10n,c.mediaSettings=window._sedAppEditorMediaSettings,c.I18n=window._sedAppEditorI18n,c.addOnSettings=window._sedAppEditorAddOnSettings,c.settings&&b.support.postMessage&&(b.support.cors||!c.settings.isCrossDomain)){b(document.body);b("#sed-app-controls").on("keydown",function(a){var c=13===a.which,d=b(a.target);c&&(d.is("input:not([type=button])")||d.is("select"))&&a.preventDefault()}),c.previewer=new c.Previewer({container:"#sed-site-preview",previewUrl:c.settings.url.preview,allowedUrls:c.settings.url.allowed,signature:"SED_APP_SIGNATURE"},{nonce:c.settings.nonce,currentElement:"body",query:function(){var a={},b=this.previewUrl();!_.isUndefined(c.currentPreviewUrl)&&c.currentPreviewUrl!==b||c.frontPageDisplayChange!==!1?(a.preview_type="new",c.currentPreviewType="new"):(a.preview_type="refresh",c.currentPreviewType="refresh");var d={};return c.each(function(a,b){a._dirty&&(d[b]=a())}),console.log("-------------dirtyCustomized---------------",d),_.extend(a,{sed_app_editor:"on",theme:c.settings.theme.stylesheet,sed_page_customized:JSON.stringify(d),sed_posts_content:JSON.stringify(c.postsContent||{}),nonce:this.nonce.preview}),c.applyFilters("sedPreviewerQueryFilter",a)}}),c.previewer.bind("nonce",function(a){b.extend(this.nonce,a)}),c.bind("nonce-refresh",function(a){b.extend(c.settings.nonce,a),b.extend(c.previewer.nonce,a),c.previewer.send("nonce-refresh",a)}),c("show_on_front","page_on_front",function(a,b){var d=function(){"page"===a()&&parseInt(b(),10)>0&&c.previewer.previewUrl.set(c.settings.url.home)};a.bind(d),b.bind(d)}),c("page_for_posts",function(a){a.bind(function(a){a=parseInt(a,10),a>0&&c.previewer.previewUrl.set(c.settings.url.home+"?page_id="+a)})}),c.previewer.bind("check_user_logged_out",function(){c.previewer.preview.iframe.hide(),c.previewer.login().done(function(){c.previewer.send("user_login_done"),c.previewer.preview.iframe.show()})}),c.previewer.bind("check_cheaters",function(){c.previewer.cheatin()})}})}(sedApp,jQuery),function(a,b){var c=sedApp.editor;c.control("style_editor_parallax_background_image",function(a){a.setting.bind(function(a){if(a){var b=c.control.instance("style_editor_background_attachment");b.update("fixed"),b.refresh("fixed")}})})}(sedApp,jQuery),function(a,b){var c=sedApp.editor;c.MSElement={},c.modulesShortcodesAttrs=c.modulesShortcodesAttrs||{},c.createRelations=c.createRelations||{},c.currenStyleEditorContolsValues=c.currenStyleEditorContolsValues||{},c.lockControlsCache=c.lockControlsCache||{},c.currentModuleForceToSelect=c.currentModuleForceToSelect||"",c.SiteEditorControls=c.Control.extend({ready:function(){var a=this;if(this.isModuleControl=!_.isUndefined(a.params)&&!_.isUndefined(a.params.category)&&"module-settings"==a.params.category,this.isStyleControl=!_.isUndefined(a.params)&&!_.isUndefined(a.params.category)&&"style-editor"==a.params.category,!this.isModuleControl||(this.attr=a.params.attr_name,this.shortcode=a.params.shortcode,this.attr)){this.isStyleControl&&(this.cssSelector=_.isUndefined(a.params.selector)?"":a.params.selector,this.cssSettingType=_.isUndefined(a.params.css_setting_type)?"module":a.params.css_setting_type);var b=!1;_.isUndefined(a.params.default_value)||_.isNull(a.params.default_value)?a.defaultValue=a.setting():(b=!0,a.defaultValue=a.params.default_value),this._ready(),b===!0?_.isUndefined(this.extraOpt)||_.isUndefined(this.extraOpt.attrs)?_.isUndefined(this.extraOpt)||_.isEmpty(this.extraOpt)?this.update():this.update(this.extraOpt):this.update(this.extraOpt.attrs):this.currentValue=a.setting()}},refresh:function(a,b){var d=this;if(this.isModuleControl){var e;d.previewer.send("current_shortcode",d.shortcode),d.previewer.send("current_attr",d.attr),_.isUndefined(d.params.sub_shortcodes_update)||_.isUndefined(d.params.sub_shortcodes_update["class"])||_.isUndefined(d.params.sub_shortcodes_update.attr)||d.previewer.send("subShortcodesAttrUpdate",{"class":d.params.sub_shortcodes_update["class"],attr:d.params.sub_shortcodes_update.attr,value:a}),e=_.isUndefined(d.params.force_refresh)||d.params.force_refresh!==!0?"normal":"force_refresh",d.previewer.send("current_attr_status",e)}if(this._refresh(a),this.isStyleControl){var f;f="module"==this.cssSettingType?"sed_current"!=this.cssSelector?'[sed_model_id="'+c.currentTargetElementId+'"] '+this.cssSelector:'[sed_model_id="'+c.currentTargetElementId+'"]':this.cssSelector,this.previewer.send("current_css_setting_type",this.cssSettingType),this.previewer.send("current_css_selector",f);var g=this.settings["default"].id;"page"==this.cssSettingType&&(f="##sed_current_page##"+this.cssSelector),_.isUndefined(c.currenStyleEditorContolsValues[f])&&(c.currenStyleEditorContolsValues[f]={}),c.currenStyleEditorContolsValues[f][g]=a}this.setValue(a),this.currentValue=a,this.isModuleControl&&!_.isUndefined(d.params.sub_category)&&this.setAtts(a),_.isUndefined(d.params.sub_category)||_.isEmpty(d.params.sub_category)||c.Events.trigger("afterControlValueRefresh",d.params.sub_category,d,a),this.refreshLockControls(a,b),c.Events.trigger("after_control_value_refresh_event",d,a)},setValue:function(a){var d=this;b.isArray(a)&&(a=a.join(",")),a=c.applyFilters(d.setting.id+"_set",a,d.id),d.setting.set(a)},update:function(a){var d,e=this;if(this.isModuleControl&&!_.isUndefined(a)&&_.isObject(a)){var f=b.extend(!0,{},a);_.isUndefined(f)||_.isUndefined(f[e.attr])?d=e.defaultValue:(d=f[e.attr],this.setAtts(f,"all"))}else if(this.isStyleControl){var g=c.appStyleEditorSettings.getCurrentValue(e.id,e.params,e.cssSelector,e.cssSettingType);d=_.isNull(g)?e.defaultValue:_.clone(g)}else d=_.isUndefined(a)?e.defaultValue:a;this.currentValue=d,this._update(d),this.isModuleControl&&c.Events.trigger("moduleControlUpdate",e.shortcode,e.attr,d)},setAtts:function(a,b){if(a)switch(b=b?b:"current"){case"current":_.isUndefined(c.modulesShortcodesAttrs[this.shortcode])&&(c.modulesShortcodesAttrs[this.shortcode]={}),c.modulesShortcodesAttrs[this.shortcode][this.attr]=a;break;case"all":c.modulesShortcodesAttrs[this.shortcode]=a}},refreshLockControls:function(a,b){var d=this;if(!_.isUndefined(d.params.lock_id)&&(_.isUndefined(b)||b===!1)){var e=c.control.instance(d.params.lock_id);if(e&&!_.isUndefined(e.currentValue)&&e.currentValue){var f=this.findLockControls(e.id),g=[];_.each(f,function(a){var b=a.control_id,d=c.control.instance(b);g.push(d)}),_.each(g,function(b){b.refresh(a,!0),b.update(a)})}}},findLockControls:function(a){if(!_.isUndefined(c.lockControlsCache[a]))return c.lockControlsCache[a];var b=_.where(_.values(c.settings.controls),{lock_id:a});return c.lockControlsCache[a]=b,b},_ready:function(){},_update:function(a){},_refresh:function(a){}}),c.SedDropdownControl=c.SiteEditorControls.extend({_ready:function(){var a=this,c=this.container.find(".sed-dropdown");this.dropdown=c,_.isUndefined(a.params.options_selector)||(this.statuses=b(a.params.options_selector,c),_.isUndefined(a.params.selected_class)||(this.selectedClass=a.params.selected_class,this.updateClass=function(b){c.find("."+a.selectedClass).removeClass(a.selectedClass),b.addClass(a.selectedClass)}),this.statuses.on("click",function(c){var d;d="function"==typeof a.getValue?a.getValue(b(this)):b(this).attr("data-value"),a.params.selected_class&&a.updateClass(b(this)),a.refresh(d)}))},_update:function(a){var c,d=this,e=!_.isUndefined(d.params)&&!_.isUndefined(d.params.type)&&"gradient"==d.params.type;return d.statuses?(d.params.selected_class&&d.dropdown.find("."+d.selectedClass).removeClass(d.selectedClass),e&&_.isObject(a)?(c=_.clone(a),delete c.start,delete c.end):c=a,void d.statuses.each(function(a,f){var g;if(g="function"==typeof d.getValue?e?d.getValue(b(this),"update"):d.getValue(b(this)):b(this).attr("data-value"),!_.isObject(c)&&c==g||_.isObject(c)&&_.isEqual(g,c))return d.params.selected_class&&d.updateClass(b(this)),!1})):void(_.isUndefined(console)||_.isUndefined(console.error)?alert("not exsist or undefined options(statuses) for this control"):console.error("not exsist or undefined options(statuses) for this control"))}}),c.GradientControl=c.SedDropdownControl.extend({_ready:function(){this.getValue=function(a,c){return a.hasClass("sed-no-gradient")?"":_.isUndefined(c)||"update"!=c?{type:b(a).attr("data-gradient-type"),opacity:b(a).attr("data-gradient-opacity"),percent:b(a).attr("data-gradient-percent"),orientation:b(a).attr("data-gradient-Orientation")}:{type:b(a).attr("data-gradient-type"),opacity:b(a).attr("data-gradient-opacity"),percent:b(a).attr("data-gradient-percent"),orientation:b(a).attr("data-gradient-Orientation")}},c.SedDropdownControl.prototype._ready.apply(this,[])}}),c.SpinnerControl=c.SiteEditorControls.extend({_ready:function(){var a=this,d=this.container.find(".sed-spinner");this.spinnerOptions={},this.spinner=d,void 0!==typeof a.params.min&&(this.spinnerOptions.min=a.params.min),void 0!==typeof a.params.max&&(this.spinnerOptions.max=a.params.max),a.params.step&&(this.spinnerOptions.step=a.params.step),a.params.page&&(this.spinnerOptions.page=a.params.page),a.params.lock&&a.params.lock.id&&a.params.lock.spinner&&(this.lock=b("#"+a.params.lock.id),this.spinnerConnect=b(a.params.lock.spinner),this.controlsConnect=a.params.lock.controls||[]),d.spinner(this.spinnerOptions),d.on("spinstop keyup",function(d,e){var f=b(this).val();_.isUndefined(a.lock)||!a.lock.prop("checked")||_.isUndefined(a.spinnerConnect)||(a.spinnerConnect.val(f),_.each(a.controlsConnect,function(a){var b=c.control.instance(a);b.refresh(f)})),a.refresh(f)})},_update:function(a){this.spinner.val(a)}}),c.LockControl=c.SiteEditorControls.extend({_ready:function(){var a=this,d=this.container.find(".sed-element-control");this.lockElement=d,d.change(function(){var d=b(this).prop("checked");if(d){var e=a.findLockControls(a.id),f=[];_.each(e,function(a){var b=a.control_id,d=c.control.instance(b);f.push(d)});var g=f[0].currentValue;_.each(f,function(a){a.id!==f[0].id&&(a.refresh(g),a.update(g))})}a.refresh(d)})},_update:function(a){this.lockElement.prop("checked",a)}}),c.SpinnerLockControl=c.SiteEditorControls.extend({_ready:function(){var a=this,d=this.container.find(".sed-lock-spinner");this.spinnerLock=d,_.isUndefined(a.params.spinner)||_.isUndefined(a.params.controls)||(this.spinners=b(a.params.spinner),this.controls=a.params.controls||[],d.livequery(function(){b(this).change(function(){var d=b(this).prop("checked");if(d){var e=[];a.spinners.each(function(a,c){e.push(b(this).val())});var f=Math.min.apply(Math,e);a.spinners.each(function(a,c){b(this).val(f)}),_.each(a.controls,function(a){var b=c.control.instance(a);b.refresh(f)})}a.refresh(d)})},function(){b(this).unbind("change")}))},_update:function(a){this.spinnerLock.prop("checked",a)}}),c.ColorControl=c.SiteEditorControls.extend({_ready:function(){var a=this,b=this.container.find(".sed-colorpicker");this.picker=b;var c=_.clone(colorPickerOption);b.val(""),_.isUndefined(this.params.show_input)||(c.showInput=this.params.show_input);var d=function(b){b=_.isNull(b)?"transparent":b.toString(),a.refresh(b)},e=_.debounce(function(a){d(a)},20);c.change=function(a){d(a)},c.move=function(a){e(a)},c.dragstop=function(a){d(a)},c.hide=function(a){d(a)},this.picker.spectrum(c)},_update:function(a){a="transparent"==a?"":a,this.picker.spectrum("set",a)}}),c.FormModel=c.Class.extend({initialize:function(a,d){var e,f=this,g=c.MSElement.synchronizer.html;if(this.element=a,this.events="",d=b.extend(!0,{refresh:function(){}},d||{}),b.extend(this,d),this.element.is("input, select, textarea"))if(this.events+="change",g=c.MSElement.synchronizer.val,this.element.is("select")&&(g=c.MSElement.synchronizer.select),this.element.is("input")){e=this.element.prop("type"),c.MSElement.synchronizer[e]&&(g=c.MSElement.synchronizer[e]);var h=["text","password","tel","time","date","url","email","search"];b.inArray(e,h)>-1?this.events+=" keyup":"range"===e&&(this.events+=" input propertychange")}else this.element.is("textarea")&&(this.events+=" keyup");b.extend(this,g),this.element.bind(this.events,function(a){f.refresh(f.getVal())})}}),c.MSElement.synchronizer={},b.each(["html","val"],function(a,b){c.MSElement.synchronizer[b]={updateField:function(a){this.element[b](a)},getVal:function(){return this.element[b]()}}}),c.MSElement.synchronizer.checkbox={updateField:function(a){this.element.prop("checked",a)},getVal:function(){return this.element.prop("checked")}},c.MSElement.synchronizer.radio={updateField:function(a){this.element.filter(function(){return this.value===a}).prop("checked",!0)},getVal:function(){return this.element.filter(":checked").val()}},c.MSElement.synchronizer.select={updateField:function(a){"multiple"==this.element.attr("multiple")&&(a=_.isString(a)?a.split(","):a,a=b.isArray(a)?a:[]),this.element.val(a),this.element.trigger("change.select2")},getVal:function(){return this.element.val()}},c.SiteEditorElements=c.SiteEditorControls.extend({_ready:function(){var a=this,b=a.container.find(".sed-module-element-control");this.formModel=new c.FormModel(b,{refresh:function(b){a.refresh(b)}})},_update:function(a){this.formModel.updateField(a)}}),c.ChangeMediaControl=c.Class.extend({initialize:function(a,d){var e=this,f=a.container.find(".sed-change-media-button");this.options={},b.extend(this.options,d||{}),_.isUndefined(a.params.subtypes)||(this.options.subtypes=_.clone(a.params.subtypes)),f.livequery(function(){b(this).click(function(){c.previewer.trigger("openMediaLibrary",{options:{media:e.options}})})},function(){b(this).unbind("click")})},changeMedia:function(){}}),c.ChangeVideoControl=c.SiteEditorControls.extend({_ready:function(){var a=this,d={supportTypes:["video"],selctedType:"single",dialog:{title:_.isUndefined(a.params.lib_title)?c.I18n.change_video_library:a.params.lib_title,buttons:[{title:_.isUndefined(a.params.btn_title)?c.I18n.change_video_btn:a.params.btn_title,type:"change_media",select_validation:!0}]}};this.fieldUrl=a.container.find(".media-url-field"),this.removeBtn=a.container.find(".remove-media-src-btn"),this.removeBtn.livequery(function(){b(this).click(function(){a.refresh("")})},function(){b(this).unbind("click")}),d.eventKey="video_"+a.id,c.previewer.bind("sedChangeMedia"+d.eventKey,function(b){a.refresh(b.id)}),c.ChangeMediaControl.prototype.initialize.apply(this,[a,d])},_update:function(a){this._updateUrlField(a)},_refresh:function(a){this._updateUrlField(a)},_updateUrlField:function(a){var b=_.findWhere(c.attachmentsSettings,{id:parseInt(a)});a&&a>0&&!_.isUndefined(b)&&!_.isUndefined(b.url)?this.fieldUrl.val(b.url):this.fieldUrl.val("")}}),c.ChangeAudioControl=c.SiteEditorControls.extend({_ready:function(a,d,e){var a=this,e={supportTypes:["audio"],selctedType:"single",dialog:{title:_.isUndefined(a.params.lib_title)?c.I18n.change_audio_library:a.params.lib_title,buttons:[{title:_.isUndefined(a.params.btn_title)?c.I18n.change_audio_btn:a.params.btn_title,type:"change_media",select_validation:!0}]}};this.fieldUrl=a.container.find(".media-url-field"),this.removeBtn=a.container.find(".remove-media-src-btn"),this.removeBtn.livequery(function(){b(this).click(function(){a.refresh("")})},function(){b(this).unbind("click")}),e.eventKey="audio_"+a.id,c.previewer.bind("sedChangeMedia"+e.eventKey,function(b){a.refresh(b.id)}),c.ChangeMediaControl.prototype.initialize.apply(this,[a,e])},_update:function(a){this._updateUrlField(a)},_refresh:function(a){this._updateUrlField(a)},_updateUrlField:function(a){var b=_.findWhere(c.attachmentsSettings,{id:parseInt(a)});a&&a>0&&!_.isUndefined(b)&&!_.isUndefined(b.url)?this.fieldUrl.val(b.url):this.fieldUrl.val("")}}),c.ChangeFilesControl=c.SiteEditorControls.extend({_ready:function(a,d,e){var a=this,e={supportTypes:!_.isUndefined(a.params.support_types)&&b.isArray(a.params.support_types)?a.params.support_types:["archive","document","spreadsheet","interactive","text"],selctedType:"single",dialog:{title:_.isUndefined(a.params.lib_title)?c.I18n.change_file_library:a.params.lib_title,buttons:[{title:_.isUndefined(a.params.btn_title)?c.I18n.change_file_btn:a.params.btn_title,type:"change_media",select_validation:!0}]}};this.fieldUrl=a.container.find(".media-url-field"),this.removeBtn=a.container.find(".remove-media-src-btn"),this.removeBtn.livequery(function(){b(this).click(function(){a.refresh("")})},function(){b(this).unbind("click")}),e.eventKey="file_"+a.id,c.previewer.bind("sedChangeMedia"+e.eventKey,function(b){a.refresh(b.id)}),c.ChangeMediaControl.prototype.initialize.apply(this,[a,e])},_update:function(a){this._updateUrlField(a)},_refresh:function(a){this._updateUrlField(a)},_updateUrlField:function(a){var b=_.findWhere(c.attachmentsSettings,{id:parseInt(a)});a&&a>0&&!_.isUndefined(b)&&!_.isUndefined(b.url)?this.fieldUrl.val(b.url):this.fieldUrl.val("")}}),c.ChangeImageControl=c.SiteEditorControls.extend({_ready:function(){var a=this,d=a.container.find(".remove-img-btn");options={supportTypes:["image"],selctedType:"single",dialog:{title:_.isUndefined(a.params.lib_title)?c.I18n.change_img_library:a.params.lib_title,buttons:[{title:_.isUndefined(a.params.btn_title)?c.I18n.change_img_btn:a.params.btn_title,type:"change_media",select_validation:!0}]}},_.isUndefined(a.params.rel_size_control)||(this.relSizeControlId=a.params.rel_size_control),options.eventKey="image_"+a.id,a.imgDemo=a.container.find("img.change_img"),d.livequery(function(){b(this).click(function(){a._updateImageDemo(0),a.isStyleControl?a.refresh("none"):a.refresh("")})},function(){b(this).unbind("click")}),c.previewer.bind("sedChangeMedia"+options.eventKey,function(b){if(a._updateImageDemo(b.id),a.isStyleControl){var d=a._getImageUrl(b.id,"full")+"?attachment_id="+b.id;a.refresh(d)}else a.refresh(b.id);c.previewer.trigger("addAttachmentSizes",{id:b.id,sizes:b.sizes}),a._updateImageSizes(b.id)}),c.ChangeMediaControl.prototype.initialize.apply(this,[a,options])},_update:function(a){var b=0;b=_.isString(a)&&a.indexOf("?attachment_id=")>-1?parseInt(a.substring(a.indexOf("?attachment_id=")+15)):parseInt(a),this._updateImageDemo(b),this._updateImageSizes(b)},_updateImageDemo:function(a){var b=this._getImageUrl(a);this.imgDemo.attr("src",b)},_getImageUrl:function(a,b){var d=_.findWhere(c.attachmentsSettings,{id:parseInt(a)});if(a&&a>0&&!_.isUndefined(d))if(_.isUndefined(b)||_.isUndefined(d.sizes)||_.isUndefined(d.sizes[b]))var e=_.isUndefined(d.sizes)||_.isUndefined(d.sizes.thumbnail)?d.url:d.sizes.thumbnail.url;else var e=d.sizes[b].url;else var e=SEDNOPIC.url;return e},_updateImageSizes:function(a){!_.isUndefined(this.relSizeControlId)&&a&&a>0&&c.Events.trigger("imageUpdateUsingSizes",{controlId:this.relSizeControlId,attachId:a,customSize:!_.isUndefined(c.settings.controls[this.relSizeControlId])&&!_.isUndefined(c.settings.controls[this.relSizeControlId].has_custom_size)&&c.settings.controls[this.relSizeControlId].has_custom_size})}}),c.Events.bind("imageUpdateUsingSizes",function(a){if(!(_.isUndefined(a)||_.isUndefined(a.controlId)||_.isUndefined(a.attachId)||0==a.attachId||_.isUndefined(c.attachmentSizes[a.attachId]))){var d="",e=a.attachId,f=b("#sed_pb_"+a.controlId).val();if(!_.isUndefined(a.customSize)&&a.customSize){var g=""==b.trim(f)?'selected="selected"':"";d+='<option value="" '+g+"> "+c.I18n.custom_size+" </option>"}else b.inArray(f,_.keys(c.attachmentSizes[e]))==-1&&(f="full");_.each(c.attachmentSizes[e],function(a,b){var e=f==b?'selected="selected"':"";d+='<option value="'+b+'" '+e+"> "+c.addOnSettings.imageModule.sizes[b].label+" - "+a.width+" x "+a.height+" </option>"}),b("#sed_pb_"+a.controlId).html(d)}}),c.SiteIconControl=c.ChangeImageControl.extend({_updateImageDemo:function(a){var c=this._getImageUrl(a);this.imgDemo.attr("src",c),a>0&&c!=SEDNOPIC.url?b('link[sizes="32x32"]').attr("href",c):b('link[sizes="32x32"]').attr("href","")}}),c.MultiImagesControl=c.SiteEditorControls.extend({_ready:function(){var a=this,d=a.container.find(".remove-img-action"),e=a.container.find(".select-img-btn"),f={supportTypes:["image"],selctedType:"multiple",dialog:{title:_.isUndefined(a.params.lib_title)?c.I18n.change_img_library:a.params.lib_title,buttons:[{title:_.isUndefined(a.params.btn_title)?c.I18n.images_gallery_update:a.params.btn_title,type:"change_media",select_validation:!0}]}};this.options=f,_.isUndefined(a.params.subtypes)||(this.options.subtypes=_.clone(a.params.subtypes)),this.options.eventKey="multi_images_"+a.id,e.livequery(function(){b(this).click(function(){var d=[];_.isUndefined(a.currentValue)||_.isEmpty(a.currentValue)||(b.isArray(a.currentValue)?d=a.currentValue:_.isString(a.currentValue)&&(d=a.currentValue.split(","))),a.options.selectionSended=d,c.previewer.trigger("openMediaLibrary",{options:{media:a.options}})})},function(){b(this).unbind("click")}),a.organizeBox=a.container.find(".images-organize-box"),a.sortableImages=a.organizeBox.find(".images-sortable"),a.sortableImages.sortable({update:function(c,d){var e=[];a.sortableImages.find(">li.item-image").each(function(){var a=b(this).attr("sed-attachment-id");e.push(a)}),a.refresh(e)}}).disableSelection(),d.livequery(function(){b(this).click(function(){var c,d=b(this).parents(".item-image:first"),e=d.attr("sed-attachment-id");if(d.remove(),!_.isEmpty(a.currentValue)&&(c=a.currentValue,_.isString(c)&&(c=c.split(",")),b.isArray(c))){c=_.map(c,function(a){return parseInt(a)});var f=b.inArray(parseInt(e),c);f>-1&&(c.splice(f,1),a.refresh(c))}})},function(){b(this).unbind("click")}),c.previewer.bind("sedChangeMedia"+this.options.eventKey,function(b){var d=_.pluck(b,"id");a._updateOrganizeBox(d),a.refresh(d),_.each(b,function(a){c.previewer.trigger("addAttachmentSizes",{id:a.id,sizes:a.sizes})})})},_update:function(a){this._updateOrganizeBox(a)},_updateOrganizeBox:function(a){var d,e=this;if(e.sortableImages.html(""),!_.isEmpty(a)&&a){_.isString(a)?d=a.split(","):b.isArray(a)&&(d=a);var f="";_.each(d,function(a){var b=_.findWhere(c.attachmentsSettings,{id:parseInt(a)});if(a&&a>0&&!_.isUndefined(b))var d=b.sizes&&b.sizes.thumbnail?b.sizes.thumbnail.url:b.url;else{var d=SEDNOPIC.url;a=0}f+='<li sed-attachment-id="'+a+'" class="item-image"><img class="gallery-img" src="'+d+'" width="100" height="100"><span class="remove-img-action sedico-delete sedico"></span></li>'}),e.sortableImages.html(f)}}}),c.ChangeIconControl=c.SiteEditorControls.extend({_ready:function(){var a=this,d=a.container.find(".remove-icon-btn"),e=a.container.find(".select-icon-btn"),f={tmpl:"tmpl-dialog-icon-library",selector:"#sed-dialog-icon-library",data:{selctedType:"single",shortcodeName:"",eventKey:"change_icon_"+a.id,currentIcons:""},id:"sedDialogIconLibrary",options:{dialog_options:{autoOpen:!1,dialogClass:"icon-library-dialog",modal:!0,width:880,height:550}},extra:{}};this.sedDialog=f,e.livequery(function(){b(this).click(function(){c.Events.trigger("element_open_dialog",a.sedDialog)})},function(){b(this).unbind("click")}),a.icoDemo=a.container.find(".sed-bp-icon-demo"),d.livequery(function(){b(this).click(function(){a._updateIconDemo(""),a.refresh("")})},function(){b(this).unbind("click")}),c.Events.bind(f.data.eventKey,function(b){a._updateIconDemo(b),a.refresh(b)})},_update:function(a){this._updateIconDemo(a)},_updateIconDemo:function(a){_.isEmpty(a)&&(a="sedico sedico-icons sed-bp-icon-empty"),this.icoDemo.removeClass(this.icoDemo.attr("sed-icon")).addClass(a),this.icoDemo.attr("sed-icon",a)}}),c.OrganizeIconsControl=c.SiteEditorControls.extend({_ready:function(){var a=this,d=a.container.find(".remove-icon-action"),e=a.container.find(".select-icon-btn"),f={tmpl:"tmpl-dialog-icon-library",selector:"#sed-dialog-icon-library",data:{selctedType:"multi",shortcodeName:"",eventKey:"organize_icons_"+a.id,currentIcons:""},id:"sedDialogIconLibrary",options:{dialog_options:{autoOpen:!1,dialogClass:"icon-library-dialog",modal:!0,width:880,height:550}},extra:{}};this.sedDialog=f,e.livequery(function(){b(this).click(function(){var d="";_.isUndefined(a.currentValue)||_.isEmpty(a.currentValue)||(b.isArray(a.currentValue)?d=a.currentValue.join(","):_.isString(a.currentValue)&&(d=a.currentValue)),a.sedDialog.data.currentIcons=d,c.Events.trigger("element_open_dialog",a.sedDialog)})},function(){b(this).unbind("click")}),a.organizeBox=a.container.find(".icons-organize-box"),a.sortableIcons=a.organizeBox.find(".icons-sortable"),a.sortableIcons.sortable({update:function(c,d){var e=[];a.sortableIcons.find(">li.item-icon").each(function(){var a=b(this).attr("sed-icon");e.push(a)}),a.refresh(e)}}).disableSelection(),d.livequery(function(){b(this).click(function(){var c,d=b(this).parents(".item-icon:first"),e=d.attr("sed-icon");if(d.remove(),!_.isEmpty(a.currentValue)&&(c=a.currentValue,_.isString(c)&&(c=c.split(",")),b.isArray(c))){var f=b.inArray(e,c);f>-1&&(c.splice(f,1),a.refresh(c))}})},function(){b(this).unbind("click")}),c.Events.bind(f.data.eventKey,function(b){a._updateOrganizeBox(b),a.refresh(b)})},_update:function(a){this._updateOrganizeBox(a)},_updateOrganizeBox:function(a){var c,d=this;if(d.sortableIcons.html(""),!_.isEmpty(a)&&a){_.isString(a)?c=a.split(","):b.isArray(a)&&(c=a);var e="";_.each(c,function(a){e+='<li sed-icon="'+a+'" class="item-icon"><span class="'+a+'"></span><span class="remove-icon-action sedico-delete sedico"></span></li>'}),d.sortableIcons.html(e)}}}),c.WidgetControl=c.SiteEditorControls.extend({_ready:function(){var a=this,d=a.container.find(".widget-form");this.form=d,this.formModels=[],this.form.find(":input[name]").each(function(){var d=b(this);a.formModels.push(new c.FormModel(d,{refresh:function(b){a.previewer.send("current_widget",{fieldName:d.attr("name"),phpClass:a.container.find('[name="php_class"]').val(),idBase:a.container.find('[name="id_base"]').val(),className:a.container.find('[name="widget-classname"]').val()}),a.refresh(a._serialize())}}))}),a.defaultValue=a._serialize()},_getInputs:function(a){return b(a).find(":input[name]")},_serialize:function(){var a=this.form.find(".widget-content"),b=this._getInputs(a),c=b.serialize();return c},_update:function(a){a=decodeURIComponent(a.replace(/\+/g," "));var c=a.split("&"),d=this,e=[];b.each(c,function(a,b){if(b){var c=b.split("=");e.push(c[0]);var f=d._getInputStatePropertyName('[name="'+c[0]+'"]');if(2==c.length){var b="value"!=f||c[1];d.formModels[a].updateField(b)}}}),e=_.filter(e,function(a){return""!=b.trim(a)}),d.form.find("[type='checkbox']").each(function(){b(this).attr("name")&&b.inArray(b(this).attr("name"),e)==-1&&b(this).prop("checked",!1)})},_getInputStatePropertyName:function(a){var c=b(a);return c.is(":radio, :checkbox")?"checked":"value"}}),c.CheckBoxesControl=c.SiteEditorControls.extend({_ready:function(){var a=this;this.checkboxes=this.container.find(".sed-bp-checkbox-input"),_.isString(a.defaultValue)&&(a.defaultValue=a.defaultValue.split(",")),b.isArray(a.defaultValue)||(a.defaultValue=[]),this.checkboxes.on("change",function(){var c=[];a.checkboxes.filter(":checked").each(function(a,d){c.push(b(this).val())}),a.refresh(c)})},_update:function(a){var c=[];_.isString(a)?c=a.split(","):b.isArray(a)&&(c=a),
this.checkboxes.each(function(a,d){b.inArray(b(this).val(),c)>-1?b(this).prop("checked",!0):b(this).prop("checked",!1)})}}),c.Animations=c.SiteEditorControls.extend({_ready:function(){var a=this,c=b("#"+this.container.find(".sed-element-control").data("relatedLevelBox")),d=c.find(".sed-bp-spinner");this.animateType=c.find(".sed_pb_animation_type_class"),this.duration=c.find(".sed_pb_animation_duration"),this.delay=c.find(".sed_pb_animation_delay"),this.offset=c.find(".sed_pb_animation_offset"),this.iteration=c.find(".sed_pb_animation_iteration"),d.spinner(),d.on("spinstop",function(b,c){a.refresh(a.getValues())}),this.animateType.on("change",function(b,c){a.refresh(a.getValues())})},_update:function(a){var b=a.split(",");this.updateField("animateType",b[3]),this.animateType.trigger("change.select2"),this.updateField("duration",b[2]),this.updateField("delay",b[0]),this.updateField("offset",b[4]),this.updateField("iteration",b[1])},getValues:function(a,b){var c=[this.delay.val(),this.iteration.val(),this.duration.val(),this.animateType.val(),this.offset.val()];return c.join(",")},updateField:function(a,b){b&&"undefined"!=this[a]?this[a].val(b):"undefined"!=this[a]&&this[a].val("")}}),c.ModuleSkins=c.SiteEditorControls.extend({_ready:function(){var a=this,d=b("#"+this.container.find(".sed-element-control").data("relatedLevelBox"));this.dialog=d,this.container.find(".sed-element-control").on("click",function(){a._loadRender(b(this).data("moduleName"))}),c.Events.bind("loadSkinsDirectly",function(b){a._loadRender(b)}),d.find("li > a.pb-skin-item").livequery(function(){b(this).click(function(){a.skinItem=b(this),a.refresh(b(this).data("skinName"))})},function(){b(this).unbind("click")})},_loadRender:function(a){var c=this.dialog,d=this;b(".error-load-skins",c).hide(),d.moduleName=a,b("#sed-tmpl-modules-skins-"+d.attr+"-"+d.shortcode).length>0?(tmpl=b("#sed-tmpl-modules-skins-"+d.attr+"-"+d.shortcode),c.find(".skins-dialog-inner").html(tmpl.html())):d.loadmoduleSkins()},_refresh:function(a){this.dialog.find("li > .pb-skin-item").removeClass("pb-skin-item-selected"),this.skinItem.addClass("pb-skin-item-selected")},_update:function(a){var c;this.dialog.find("li > .pb-skin-item").removeClass("pb-skin-item-selected"),this.dialog.find("li > .pb-skin-item").each(function(){c=b(this).data("skinName"),c==a&&b(this).addClass("pb-skin-item-selected")})},loadmoduleSkins:function(){var a,d=this,e=this.dialog,f=c.template("sed-ajax-loading");a=f({type:"medium"});var g=b(a).appendTo(b(".loading",e));g.show(),b.ajax({type:"POST",url:SEDAJAX.url,data:{action:"load_skins",module:d.moduleName,shortcode:d.shortcode,default_helper_shortcodes:c.defaultHelperShortcodes,nonce:c.settings.nonce.pbSkins.load,sed_page_ajax:"module_load_skins"},error:function(){g.hide(),alert("Could not add the font because the server did not respond.Please reload the page, then try again")},success:function(a){if(g.hide(),"0"==a)return c.previewer.preview.iframe.hide(),void c.previewer.login().done(function(){c.previewer.save(),c.previewer.preview.iframe.show()});if("-1"==a)return void c.previewer.cheatin();if("-2"==a)return b(".error-load-skins",e).show(),void b(".error-load-skins span",e).html(c.I18n.invalid_data);if(b(".error-load-skins",e).hide(),a=b.parseJSON(a),a.success===!0){var f=a.data.output;e.find(".skins-dialog-inner").html(f),b('<script type="text/html" id="sed-tmpl-modules-skins-'+d.attr+"-"+d.shortcode+'">'+f+"</script>").appendTo(b("body")),a.data.js_tpl&&d.previewer.send("moduleSkinsTpl",a.data.js_tpl),a.data.data_module_skins&&d.previewer.send("dataModuleSkins",a.data.data_module_skins)}else b(".error-load-skins span").html(a.data.output)}})}}),c.controlConstructor=b.extend(c.controlConstructor,{sed_element:c.SiteEditorElements,radio:c.SiteEditorElements,"radio-image":c.SiteEditorElements,"radio-buttonset":c.SiteEditorElements,text:c.SiteEditorElements,select:c.SiteEditorElements,textarea:c.SiteEditorElements,checkbox:c.SiteEditorElements,toggle:c.SiteEditorElements,"switch":c.SiteEditorElements,image:c.ChangeImageControl,multi_images:c.MultiImagesControl,"multi-image":c.MultiImagesControl,gallery:c.MultiImagesControl,video:c.ChangeVideoControl,audio:c.ChangeAudioControl,file:c.ChangeFilesControl,dropdown:c.SedDropdownControl,spinner:c.SpinnerControl,number:c.SpinnerControl,checkboxes:c.CheckBoxesControl,multicheck:c.CheckBoxesControl,"multi-check":c.CheckBoxesControl,spinner_lock:c.SpinnerLockControl,number_lock:c.SpinnerLockControl,lock:c.LockControl,color:c.ColorControl,multi_icons:c.OrganizeIconsControl,"multi-icon":c.OrganizeIconsControl,icon:c.ChangeIconControl,animations:c.Animations,animation:c.Animations,skins:c.ModuleSkins,skin:c.ModuleSkins,widget:c.WidgetControl,gradient:c.GradientControl,"site-icon":c.SiteIconControl}),b(function(){c.defaultHelperShortcodes=window._sedAppDefaultHelperShortcodes,c.previewer.bind("moduleForceRefresh",function(a){c.currentModuleForceToSelect=a,c.previewer.refresh()}),c.previewer.bind("addAttachmentSizes",function(a){var b=a.id,d=a.sizes;_.isUndefined(c.attachmentSizes)&&(c.attachmentSizes={}),c.attachmentSizes[b]=d}),b(".open-media-library-edit-gallery").livequery(function(){b(this).click(function(){var a={supportTypes:_.isUndefined(b(this).attr("support_types"))?["image"]:b(this).attr("support_types").split(","),ShowOrganizeTab:!0,selctedType:"multiple",activeTab:"organize",media_attrs:_.isUndefined(b(this).attr("media_attrs"))?["attachment_id","image_url","image_source"]:b(this).attr("media_attrs").split(","),organizeTab:{title:_.isUndefined(b(this).attr("organize_tab_title"))?c.I18n.organize_tab_title:b(this).attr("organize_tab_title"),buttons:[{title:_.isUndefined(b(this).attr("update_btn_title"))?c.I18n.update_btn_title:b(this).attr("update_btn_title"),type:"update_media_collection"},{title:_.isUndefined(b(this).attr("cancel_btn_title"))?c.I18n.cancel_btn_title:b(this).attr("cancel_btn_title"),type:"cancel"}]},dialog:{title:_.isUndefined(b(this).attr("lib_title"))?c.I18n.change_img_library:b(this).attr("lib_title"),buttons:[{title:_.isUndefined(b(this).attr("add_btn_title"))?c.I18n.add_btn_title:b(this).attr("add_btn_title"),type:"add_to_collection",select_validation:!0}]}};c.previewer.send("openMediaLibraryEditGallery",a)})},function(){b(this).unbind("click")})})}(sedApp,jQuery),function(a,b){var c=sedApp.editor;c.AppPreview=c.Class.extend({initialize:function(a){b.extend(this,a||{}),this.previewMode="off",this.changePreviewer=!1,this.ready()},ready:function(){var a=this;c.addFilter("sedPreviewerQueryFilter",function(b){return"on"==a.previewMode&&(a.changePreviewer=!0),b}),c.previewer.bind("previewerActive",function(){"on"==a.previewMode&&c.previewer.send("previewMode",a.previewMode)}),b("#app-preview-mode-btn").on("click",function(){a.previewMode="on",b("body").addClass("sed-app-preview"),c.previewer.send("previewMode",a.previewMode),a.dialogsClosed()}),b("#back-to-editor-btn").on("click",function(){a.previewMode="off",b("body").removeClass("sed-app-preview"),c.previewer.send("previewMode",a.previewMode),b("#website").css("width","100%"),a.changePreviewer===!1?a.dialogsOpened():a.changePreviewer=!1}),b(".preview-mode-toolbar .preview-mode").on("click",function(){var a,c=b(this).data("previewMode");switch(c){case"tablets-landscape-mode":a=1023;break;case"tablets-portrait-mode":a=767;break;case"smartphones-landscape-mode":a=479;break;case"smartphones-portrait-mode":a=319}"desktop-mode"==c?a="100%":a+="px",b("#website").css("width",a),b("#website").addClass(c+"-iframe")})},dialogsClosed:function(){var a=this;this.openDialogs=[],b(".ui-dialog-content").each(function(){b(this).dialog("isOpen")&&(b(this).dialog("close"),a.openDialogs.push(b(this)))})},dialogsOpened:function(){_.each(this.openDialogs,function(a){a.dialog("open")})}}),b(function(){c.appPreview=new c.AppPreview})}(sedApp,jQuery),function(a,b){var c,d,e,f,g=sedApp.editor;g.TemplatesControl=g.Control.extend({ready:function(){var a,e=this;this.container.find(".sed-select-template"),e.setting();this.currentValue="",b("#sed-dialog-confirm-change-template").dialog({width:400,height:"auto",modal:!0,autoOpen:!1,close:function(){b("#change-template-settings-form").hide()}}),b(c.dialog.selector).find(".sed-template").livequery(function(){b(this).on("click",function(c){return c.preventDefault(),e.currentValue=b(this).attr("data-value"),_.isEmpty(e.currentValue)?alert("template is invalid"):(a=_.findWhere(d.all.models,{id:e.currentValue}),b("#sed-dialog-confirm-change-template").dialog("open"),void b("#change-template-alert-confirm").show())})}),b("#cancel-change-template-btn").livequery(function(){b(this).click(function(){b("#sed-dialog-confirm-change-template").dialog("close")})}),b("#ok-change-template-btn").livequery(function(){b(this).click(function(){b("#change-template-alert-confirm").hide(),b("#change-template-settings-form").show(),_.isUndefined(a.options.settings.sed_main_content_shortcode)||_.isUndefined(g.mainContentShortcode)||a.options.settings.sed_main_content_shortcode!=g.mainContentShortcode?(b("#remain-content-container-field").find('[name="remain-content-container"]').prop("checked",!1),b("#remain-content-container-field").hide()):(b("#remain-content-container-field").find('[name="remain-content-container"]').prop("checked",!0),b("#remain-content-container-field").show()),"post"==g.settings.page.type?b("#apply-main-content-field").show():b("#apply-main-content-field").hide()})}),b("#confirm-change-template-btn").livequery(function(){b(this).click(function(){var d,f,h=b("#change-template-settings-form"),i=h.serializeArray();b.each(i,function(a,b){switch(b.name){case"change-main-content":d=b.value;break;case"remain-content-container":f=b.value}}),e.setting.set(e.currentValue);var j=new g.ChangeTemplate,k=j.loadPageTemplate(a,f,d),l={},m=k.settings;l[g.settings.page.id]=k.main_content||[],m.theme_content=k.theme_content,g.pageCustomizedSettings=m,g.postsContent=l,g.previewer.refresh(),delete g.pageCustomizedSettings,b("#sed-dialog-confirm-change-template").dialog("close"),b(c.dialog.selector).dialog("close")})})},update:function(){var a=this;a.setting()}}),g.controlConstructor=b.extend(g.controlConstructor,{templates:g.TemplatesControl}),g.ChangeTemplate=g.Class.extend({initialize:function(){this.mainShortcodeType,this.applyMainContent,this.remainMainShortcodes,this.newThemeShortcodeModels,this.CurrThemeShortcodeModels,this.newMainContentModels,this.CurrMainContentModels,this.CurrPageSettings,this.newPageSettings,this.remainOldIds=[],this.template,this.output={},this.ids=[]},loadPageTemplate:function(a,b,c){return this.template=a,_.isUndefined(a.options.settings.sed_main_content_shortcode)||_.isUndefined(g.mainContentShortcode)||a.options.settings.sed_main_content_shortcode!=g.mainContentShortcode?this.mainShortcodeType="unequal":this.mainShortcodeType="equal",this.CurrThemeShortcodeModels=g("theme_content")(),this.newThemeShortcodeModels=a.options.settings.sed_page_customized.theme_content,this.CurrMainContentModels=g.postsContent[g.settings.page.id],this.newMainContentModels=a.options.settings.sed_posts_content,this.CurrPageSettings=g.get(),this.newPageSettings=a.options.settings.sed_page_customized,this.applyMainContent=c,this.remainMainShortcodes=b,this.replaceThemeContent(),"post"==g.settings.page.type&&("override"==this.applyMainContent?this.replaceMainContent():"merge"==this.applyMainContent?this.appendMainContent():this.output.main_content=this.CurrMainContentModels),this.modifyOldSettings(),this.modifyNewSettings(),this.mergeSettings(),this.output},replaceThemeContent:function(){"equal"==this.mainShortcodeType&&this.remainMainShortcodes===!0||"unequal"==this.mainShortcodeType?this.remainMainOldShortcodes():this.output.theme_content=this.newThemeShortcodeModels},remainMainOldShortcodes:function(){var a=this,b=-1,c=_.find(this.newThemeShortcodeModels,function(a,c){return b=c,!_.isUndefined(a.attrs)&&!_.isUndefined(a.attrs.sed_main_content)&&!_.isUndefined(a.attrs.sed_main_content)&&"true"==a.attrs.sed_main_content}),d=c.parent_id,e=this.findAllTreeChildrenShortcode(this.newThemeShortcodeModels,c.id);this.newThemeShortcodeModels=this.deleteShortcodesTreeChildren(this.newThemeShortcodeModels,e),this.newThemeShortcodeModels.splice(b,1),this.newThemeShortcodeModels=this.modifyAllShortcodesIds(this.newThemeShortcodeModels);var f=_.find(this.ids,function(a){return a.oldId==d}),g=f.newId,h=_.find(this.CurrThemeShortcodeModels,function(a,b){return!_.isUndefined(a.attrs)&&!_.isUndefined(a.attrs.sed_main_content)&&!_.isUndefined(a.attrs.sed_main_content)&&"true"==a.attrs.sed_main_content});h.parent_id=g;var i=this.findAllTreeChildrenShortcode(this.CurrThemeShortcodeModels,h.id);i.unshift(h),_.each(i,function(b){a.remainOldIds.push(b.id)}),this.newThemeShortcodeModels=this.addShortcodesToModels(i,this.newThemeShortcodeModels,b),this.output.theme_content=this.newThemeShortcodeModels},replaceMainContent:function(){this.newMainContentModels=this.modifyAllShortcodesIds(this.newMainContentModels),this.output.main_content=this.newMainContentModels},appendMainContent:function(){var a=this;_.each(this.CurrMainContentModels,function(b){a.remainOldIds.push(b.id)}),this.newMainContentModels=this.modifyAllShortcodesIds(this.newMainContentModels),this.output.main_content=_.uniq(_.union(this.CurrMainContentModels,this.newMainContentModels),function(a,b,c){return a.id})},modifyAllShortcodesIds:function(a){var c=this;return a=_.map(a,function(d){var e,f;if("content"!=d.tag){if(f=g.shortcodes[d.tag],"undefined"==typeof f)return;e=f.asModule?c.getNewId(f.moduleName):c.getNewId(d.tag,"shortcode")}else e=c.getNewId(d.tag,"shortcode");return c.ids.push({oldId:d.id,newId:e}),b.each(a,function(a,b){b.parent_id==d.id&&(b.parent_id=e)}),d.id=e,_.isUndefined(d.attrs)&&(d.attrs={}),d.attrs.sed_model_id=e,d})},modifyOldSettings:function(){var a=this,c=g.styleEditorSettings,d=_.map(this.remainOldIds,function(a){return"#"+a});b.each(this.CurrPageSettings,function(a,e){b.inArray(a,c)!=-1&&b.each(e,function(a,c){index=b.inArray(a,d),index==-1&&delete e[a]})}),b.each(this.CurrPageSettings.sed_pb_modules,function(c,d){index=b.inArray(c,a.remainOldIds),index==-1&&delete a.CurrPageSettings.sed_pb_modules[c]})},modifyNewSettings:function(){var a=this,c=g.styleEditorSettings,d=_.pluck(this.ids,"oldId"),e=_.map(d,function(a){return"#"+a}),f=_.pluck(this.ids,"newId"),h=_.map(f,function(a){return"#"+a});b.each(a.newPageSettings,function(a,d){b.inArray(a,c)!=-1&&b.each(d,function(a,c){index=b.inArray(a,e),index>-1&&(d[h[index]]=c,delete d[a])})}),b.each(a.newPageSettings.sed_pb_modules,function(c,e){index=b.inArray(c,d),index>-1&&(a.newPageSettings.sed_pb_modules[f[index]]=e,delete a.newPageSettings.sed_pb_modules[c])})},mergeSettings:function(){var a=b.extend({},this.CurrPageSettings,this.newPageSettings);this.output.settings=a},getNewId:function(a,b){var c,d=g.settings.page.id;return b=b||"module","module"==b?("undefined"==typeof g.modules[d][a]?g.modules[d][a]={length:1}:g.modules[d][a].length+=1,c="sed-bp-module-"+a+"-"+d+"-"+g.modules[d][a].length):("undefined"==typeof g.childShortcode[d][a]?g.childShortcode[d][a]={length:1}:g.childShortcode[d][a].length+=1,c="sed-bp-shortcode-"+a+"-"+d+"-"+g.childShortcode[d][a].length),c},deleteShortcodesTreeChildren:function(a,b){for(var c=0;c<b.length;c++)for(var d=0;d<a.length;d++){var e=a[d];if(e.id==b[c]){a.splice(d,1);break}}return a},findAllTreeChildrenShortcode:function(a,c){var d=this,e=[];return b.each(a,function(f,g){g.parent_id==c&&(e.push(g),e=b.merge(e,d.findAllTreeChildrenShortcode(a,g.id)))}),e},addShortcodesToModels:function(a,c,d){var e=this;return a=a.reverse(),b.each(a,function(a,b){b=e.modifyShortcode(b),c.splice(d,0,b)}),c},modifyShortcode:function(a){var b={};for(var c in a.attrs)b[c]=a.attrs[c];return b.id=a.id,a.attrs=b,a}}),f=g.Template=g.Class.extend({initialize:function(a){b.extend(this,a||{}),f.create(this)},sync:function(a,b,c){},parse:function(a){return a?(a.date=new Date(a.date),a.modified=new Date(a.modified),a):a}},{create:function(a){return d.all.models=_.uniq(d.all.models,function(a,b,c){return a.id}),d.all.models.push(a)},get:_.memoize(function(a,b){return d.all.push(b||{id:a})})}),d=g.Templates=g.Class.extend({initialize:function(a,b){this.models=[],this.props=b&&b.props?b.props:{},this.modelsTemplate="",this.cid=this.cid?this.cid+1:1},changedView:function(a,b){var c=g.template("sed-template-lib-item");switch(a){case"append":this.modelsTemplate+=c(b);break;case"remove":break;case"preFrom":break;case"nextFrom":}},fetch:function(a){var b=this;return a=a?_.clone(a):{},a.success=function(c){return 0!=c.length&&(_.each(c,function(c,d){b.addModel(c,a)}),void(b.models=_.uniq(b.models,function(a,b,c){return a.id})))},this.sync(a)},addModel:function(a,b){var c=this,d=new f(a);c.models.push(d),c.length=c.models.length},removeModel:function(a){var b=this;b.removeModelById(a.id)},removeModelById:function(a){this.models=_.filter(this.models,function(b){return b.id!=a})}},{filters:{search:function(a,b){return!a.search||_.any(["title","name","description","tags","author"],function(c){var d=b.get(c);return d&&-1!==d.search(a.search)},this)},type:function(a,b){var c=a.type;return!c||c==b.type}}}),d.all=new d,e=g.TemplateQuery=g.Templates.extend({initialize:function(a,b){b=b||{},d.prototype.initialize.apply(this,arguments),this.args=b.args,this._hasMore=!0,this.created=new Date,this.length=0},hasMore:function(){return this._hasMore},more:function(a){var c=this;return this._more&&"pending"===this._more.state()?this._more:this.hasMore()?(a=a||{},a.remove=!1,this._more=this.fetch(a).done(function(a){(_.isEmpty(a)||-1===this.args.item_per_page||a.length<this.args.item_per_page)&&(c._hasMore=!1)})):b.Deferred().resolveWith(this).promise()},sync:function(a){var b;return a=a||{},a.context=this,a.data=_.extend(a.data||{},{action:"load_templates",nonce:g.addOnSettings.template.nonce.load,sed_page_ajax:"sed_load_templates"}),b=_.clone(this.args),-1!==b.item_per_page&&(b.paged=Math.floor(this.length/b.item_per_page)+1),a.data.query=b,g.wpAjax.send(a)}},{defaultProps:{orderby:"date",order:"DESC"},defaultArgs:{item_per_page:6},orderby:{allowed:["name","author","date","title","id"],valuemap:{id:"template_id"}},propmap:{search:"s",type:"group",perPage:"item_per_page"},get:function(){var a=[];return function(b,c){var d,f={},g=e.orderby,h=e.defaultProps,i=!!b.cache||_.isUndefined(b.cache);return delete b.query,delete b.cache,_.defaults(b,h),b.order=b.order.toUpperCase(),"DESC"!==b.order&&"ASC"!==b.order&&(b.order=h.order.toUpperCase()),_.contains(g.allowed,b.orderby)||(b.orderby=h.orderby),_.each(b,function(a,b){_.isNull(a)||(f[e.propmap[b]||b]=a)}),_.defaults(f,e.defaultArgs),f.orderby=g.valuemap[b.orderby]||b.orderby,i?d=_.find(a,function(a){return _.isEqual(a.args,f)}):a=[],d||(d=new e([],_.extend(c||{},{props:b,args:f})),a.push(d)),e.queries=a,d}}()}),c=g.AppTemplate=g.Class.extend({initialize:function(a){this.currentType="",this.template,this.search="",this.ajaxProcessing=!1,this.libLoadProcessing=!1,b.extend(this,a||{}),this.ready()},ready:function(){var a=this;b(c.dialog.selector).dialog(c.dialog.options),b("#sed-app-control-select_template").on("click",function(){b(c.dialog.selector).dialog("open"),a.set({type:a.currentType})});var d=_.debounce(function(){var c={type:a.currentType};b.trim(a.search)&&(c.search=a.search),a.set(c,!0)},100);b(c.container).mCustomScrollbar({advanced:{updateOnBrowserResize:!0,updateOnContentResize:!0},scrollButtons:{enable:!0},callbacks:{onTotalScroll:function(){a.ajaxProcessing===!1&&a.libLoadProcessing===!1&&(a.libLoadProcessing=!0,d())},onTotalScrollOffset:120}}),b(c.searchBox).on("keyup",function(){a.search=b(this).val();var c={type:a.currentType};b.trim(a.search)&&(c.search=a.search),a.set(c)}),b(c.filterBox).on("change",function(){var d=b(this).val();a.currentType="all"==d?"":d;var e={type:a.currentType};b.trim(a.search)&&(e.search=a.search),b(c.library).html(""),a.set(e)}),b("#save_as_new_template").click(function(){b("#sed-dialog-save-new-template").dialog("open")}),b("#sed-dialog-save-new-template").dialog({height:400,width:400,modal:!1,autoOpen:!1}),b("#add-new-template-btn").on("click",function(){a.addNewTemplate()}),b("#select-sed-template-screenshot").on("click",function(){g.previewer.trigger("openMediaLibrary",{options:{media:{supportTypes:["image"],selctedType:"single",dialog:{buttons:[{type:"change_media",select_validation:!0}]},eventKey:"TemplateScreenshot"}}})}),g.previewer.bind("sedChangeMediaTemplateScreenshot",function(a){var c=g.template("sed-template-screenshot");a.imgUrl=a.sizes&&a.sizes.medium?a.sizes.medium.url:a.url;var d=c(a);b("#sed-template-screenshot-preview").html(d),b("form.add-new-template").find('[name="screenshot"]').val(a.imgUrl)})},set:function(a,b){var c=this,d=g.TemplateQuery.get(a),e=d.args.item_per_page;return d.length>=e&&!b||!d._hasMore?(c.libView(d),void(c.libLoadProcessing=!1)):(c.ajaxProcessing=!0,void d.more().done(function(){c.libView(d),c.libLoadProcessing=!1,c.ajaxProcessing=!1}))},libView:function(a){var d="",e=this;this.template=g.template("sed-template-lib-item"),_.each(a.models,function(a,b){d+=e.template(a)}),b(c.library).html(d)},addNewTemplate:function(){var a,c=_.pluck(g.attachmentsSettings,"id"),d=_.omit(g.pageModuleUsing,"id");a=_.map(d,function(a){return JSON.stringify(a)}),a=_.uniq(a),d=_.map(a,function(a){return b.parseJSON(a)});var e=this,f=b("form.add-new-template"),h=f.serializeArray(),i={options:{requirement:{modules:d,medias:c,icons_fonts:{},fonts:{},widgets:{},posts:{}},settings:{sed_main_content_shortcode:g.mainContentShortcode||"",sed_page_customized:g.get(),sed_posts_content:g.postsContent[g.settings.page.id]||[]}}};b.each(h,function(a,b){i[b.name]=b.value});var j=function(a,c){var d=g.template("sed-save-template-alert"),e={output:a,alertType:c},f=d(e);b("#save-template-alert-box").html(f)};new g.Ajax({data:{template:JSON.stringify(i),action:"save_template",nonce:g.addOnSettings.template.nonce.save,sed_page_ajax:"sed_save_template"},success:function(){f[0].reset(),b("#sed-template-screenshot-preview").html(""),j(this.response.data.output,"success"),e.addSaveTemplateModel(this.response.data.template);var a={type:e.currentType};b.trim(e.search)&&(a.search=e.search),e.set(a)},error:function(){j(this.response.data.output,"error")}},{container:"body",repeatRequest:!0})},addSaveTemplateModel:function(a){var a=new f(a);queries=e.queries,_.each(queries,function(b,c){var e=b.props;d.filters.search(e,a)&&d.filters.type(e,a)&&(b.models.unshift(a),b.length=b.models.length)})}},{dialog:{selector:"#sed-dialog-template-library",options:{dialogClass:"dialog-template-library",autoOpen:!1,modal:!0,width:900,height:600,buttons:{Cancel:function(){b(this).dialog("close")}}}},library:"#site-editor-template-library",searchBox:"#template-library-search",filterBox:"#template-group-filter",container:"#sed-template-library-container"}),b(function(){g.previewer.bind("mainContentShortcodeUpdate",function(a){g.mainContentShortcode=a}),g.appTemplate=new g.AppTemplate})}(sedApp,jQuery),function(a,b){var c=sedApp.editor;c.fn.pageBuilderModuleExist=function(a){var c='[sed_role="'+a+'"]',d=b("#website")[0].contentWindow.jQuery(c);return d.length},b(function(){if(c.settings=window._sedAppEditorSettings,c.l10n=window._sedAppEditorControlsL10n,c.postsContent=c.postsContent||{},c.pagesThemeContent=c.pagesThemeContent||{},c.modules={},c.childShortcode={},c.moduleDragSync=!1,c.shortcodes=window._sedRegisteredShortcodesSettings,console.log("-------------api.shortcodes--------------",c.shortcodes),c.shortcodesScripts=window._sedRegisteredShortcodesScripts,c.shortcodesStyles=window._sedRegisteredShortcodesStyles,c.modulesSettings=window._sedAppEditorPageBuilderModules,c.defaultPatterns=window._sedShortcodesDefaultPatterns,c.ModulesEditorJs=window._sedAppJsModulesForEditor,c.settings){if(!b.support.postMessage||c.settings.isCrossDomain)return window.location=c.settings.url.fallback;c.previewer.bind("previewerActive",function(){c.previewer.send("sed_api_shortcodes",c.shortcodes),c.previewer.send("sed_api_shortcodes_scripts",c.shortcodesScripts),c.previewer.send("sed_api_shortcodes_styles",c.shortcodesStyles),c.previewer.send("sed_api_modules_settings",c.modulesSettings),c.previewer.send("sed_api_modules_editor_js",c.ModulesEditorJs),c.currentModuleForceToSelect&&(c.previewer.send("sed_force_select_module",c.currentModuleForceToSelect),c.currentModuleForceToSelect="")}),c.previewer.bind("checkModuleDragSync",function(){c.moduleDragSync===!0&&b.SiteEditorDroppable.destroy('[data-type-row="draggable-element"]',"website");var a=function(a){var c={};return b.each(a.attributes,function(){this.specified&&(c[this.name]=this.value)}),c};b.sedDroppable('[data-type-row="draggable-element"]',{iframe:"website",dragStart:function(a,b,c){},stop:function(a,b,c){},drop:function(b,d){var e=a(d.helper[0]);c.previewer.send("moduleDragHandler",{option:"drop",args:{ui:{offset:d.offset},element:{attrs:e,data:d.helper.data()}},mode:c.moduleDragSync})}}),c.moduleDragSync!==!0&&(b(".sed-module-pb").sedDraggable({scrollSensitivity:30,scrollSpeed:30,dropInSortable:".sed-pb-component,.sed-pb-main-component",items:".sed-row-pb",cancelSortable:'[data-type-row="draggable-element"],[sed-disable-editing="yes"]',iframeSortable:"website",placeholder:"<div class='sed-state-highlight-row'></div>",dragStart:function(a,d,e){b("#iframe_cover").show(),c.previewer.send("moduleDragStart"),c.Events.trigger("moduleDragStartEvent",e.attr("sed-module-name"))},stop:function(a,c,d){b("#iframe_cover").hide()},out:function(a,b,c){var d;d=c.items!==!1?b.children(c.items).not('[data-type-row="draggable-element"]'):b.children().not('[data-type-row="draggable-element"]'),0!=d.length||b.hasClass("sed-pb-empty-sortable-area")||b.addClass("sed-pb-empty-sortable-area")},over:function(a,b,c){b.hasClass("sed-pb-empty-sortable-area")&&b.removeClass("sed-pb-empty-sortable-area")},sortStop:function(d,e){var f=a(e.helper[0]);if(!_.isUndefined(e.sortable.data("parentModule"))){var g=e.sortable.data("modulesAccepted");if(g=g.split(","),g=_.map(g,function(a){return b.trim(a)}),g=_.filter(g,function(a){return a}),b.inArray(f["sed-module-name"],g)==-1)return alert(e.sortable.data("modulesAcceptedError")),void c.previewer.send("moduleDragStop")}c.previewer.send("moduleDragHandler",{option:"sortStop",args:{ui:{direction:e.direction},element:{attrs:f,data:e.helper.data()}},mode:c.moduleDragSync}),c.previewer.send("moduleDragStop")}}),c.moduleDragSync===!1&&(c.moduleDragSync=!0))}),c.previewer.bind("page_custom_design_settings",function(a){var b;b="post"==c.settings.page.type?"postmeta["+c.settings.currentPostType+"]["+c.settings.page.id+"][page_custom_design_settings]":"sed_"+c.settings.page.id+"_settings[page_custom_design_settings]",c(b).set(a)}),c.previewer.bind("site_custom_design_settings",function(a){c("site_custom_design_settings").set(a)}),c.previewer.bind("resetpageInfoSettings",function(a){_.isUndefined(a.pageId)||_.isUndefined(a.pageType)||(c.settings.page.id=a.pageId,c.settings.page.type=a.pageType,c.settings.currentPostType=a.postType,c.Events.trigger("afterResetpageInfoSettings"))}),c.previewer.bind("currentPageInfo",function(a){c.currentPageInfo=a,c.currentPageInfo.isHome===!0&&c.currentPageInfo.isFrontPage===!0?(b(".home-blog-control").parents("td:first").show(),c.isHomeBlog=!0):(b(".home-blog-control").parents("td:first").hide(),c.isHomeBlog=!1),c.currentPageInfo.isHome===!1&&c.currentPageInfo.isFrontPage===!0?(b(".home-page-control").parents("td:first").show(),c.isHomePage=!0):(b(".home-page-control").parents("td:first").hide(),c.isHomePage=!1),c.currentPageInfo.isHome===!0&&c.currentPageInfo.isFrontPage===!1?(b(".index-blog-control").parents("td:first").show(),c.isIndexBlog=!0):(b(".index-blog-control").parents("td:first").hide(),c.isIndexBlog=!1),c.currentPageInfo.isHome===!0&&c.currentPageInfo.isFrontPage===!0||c.currentPageInfo.isHome===!1&&c.currentPageInfo.isFrontPage===!0?(b(".home-control").parents("td:first").show(),c.isHome=!0):(b(".home-control").parents("td:first").hide(),c.isHome=!1)}),c.previewer.bind("posts_content_ready",function(a){if(!_.isUndefined(a)){var d=b.extend(!0,{},a);b.each(d,function(a,b){c.postsContent[a]=b})}}),c.previewer.bind("posts_content_update",function(a){if(c.trigger("change"),!_.isUndefined(a)){var d=b.extend(!0,{},a);b.each(d,function(a,b){c.postsContent[a]=b})}}),c.previewer.bind("syncPreLoadSettings",function(a){_.each(a,function(a,b){if(!c.has(b)){var d=c.create(b,b,a.value,{transport:a.transport||"refresh",previewer:c.previewer,stype:"general",dirty:a.dirty});c.settings.settings[b]=a,a.dirty&&d.callbacks.fireWith(d,[d.get(),{}])}})}),c.previewer.bind("pages_theme_content_ready",function(a){"post"==c.settings.page.type?(c.currentPageThemeContentSettingId="postmeta["+a.postType+"]["+c.settings.page.id+"][theme_content]",c.currentPageLayoutSettingId="postmeta["+a.postType+"]["+c.settings.page.id+"][page_layout]",c.settings.currentPostType=a.postType):(c.currentPageThemeContentSettingId="sed_"+c.settings.page.id+"_settings[theme_content]",c.currentPageLayoutSettingId="sed_"+c.settings.page.id+"_settings[page_layout]"),c.pagesThemeContent=a.content,c.Events.trigger("sedAfterThemeContentReady")}),c.previewer.bind("pages_theme_content_update",function(a){c.trigger("change"),c.pagesThemeContent=a,c.Events.trigger("sedAfterThemeContentUpdate")}),c.previewer.bind("set_editor_current_page",function(a){!_.isUndefined(a.changePage)&&a.changePage&&c.trigger("change"),_.isUndefined(a.page)||(c.settings.page=a.page)}),c.previewer.bind("dataModulesSkinsCache",function(a){c.dataModulesSkinsCache=a||{}}),c.previewer.bind("moduleSkinsTplCache",function(a){c.moduleSkinsTplCache=b.extend(!0,c.moduleSkinsTplCache||{},a||{})}),c.previewer.bind("previewerActive",function(){_.isUndefined(c.dataModulesSkinsCache)||c.previewer.send("dataModuleSkins",c.dataModulesSkinsCache),_.isUndefined(c.moduleSkinsTplCache)||c.previewer.send("moduleSkinsTpl",c.moduleSkinsTplCache)}),c.previewer.bind("syncAttachmentsSettings",function(a){_.isUndefined(a)||(c.attachmentsSettings=a,_.each(a,function(a,b){c.previewer.trigger("addAttachmentSizes",{sizes:b.sizes,id:b.id})}))}),b(".site-editor-app-tools-button .sed-module-gideline").click(function(){b(this).hasClass("modules-guideline-on")?(b(this).removeClass("modules-guideline-on"),c.previewer.send("modulesGuidelineOff")):(b(this).addClass("modules-guideline-on"),c.previewer.send("modulesGuidelineOn"))}),c.megamenuDragArea={},c.previewer.bind("megamenuDragAreaMode",function(a){c.megamenuDragArea=a,"on"==a.mode?b("#app-preview-mode-btn").prop("disabled",!0):"off"==a.mode&&b("#app-preview-mode-btn").prop("disabled",!1)}),c.previewer.bind("previewerActive",function(){_.isUndefined(c.megamenuDragArea.mode)||"on"!=c.megamenuDragArea.mode||c.previewer.send("megamenuDragAreaActiveAfterRefresh",c.megamenuDragArea)}),c.previewer.bind("pageWidgetsList",function(a){var b=c.instance("page_widgets_list");b.set(a)}),c.Events.bind("after_control_value_refresh_event",function(a,b){_.isUndefined(a.params)||_.isUndefined(a.params.style_props)||"font-family"!==a.params.style_props||c.previewer.send("changeFontFamilyControl",b)})}})}(sedApp,jQuery),function(a,b){var c=sedApp.editor;c.sedAppLoadedScripts=c.sedAppLoadedScripts||[],b(function(){if(c.settings=window._sedAppEditorSettings,c.wpScripts=window._wpRegisteredScripts,c.widgetScripts=window._sedAppWidgetScripts,c.l10n=window._sedAppEditorControlsL10n,c.settings){if(!b.support.postMessage||c.settings.isCrossDomain)return window.location=c.settings.url.fallback;c.Events.bind("sedDialogWebAddress",function(a){});var a=[],d=function(d){var e="undefined"!=typeof d.data.dialogTmplType?d.data.dialogTmplType:"static";b.inArray(d.selector,a)==-1&&(a.push(d.selector),b(d.selector).dialog(d.options.dialog_options),"static"==e&&(b(d.selector).html(b("#"+d.tmpl).html()),"undefined"==typeof d.options.dialog_options.title&&b(d.selector).dialog("option","title",b("#"+d.tmpl).attr("data-dialog-title")))),
"dynamic"==e&&(b(d.selector).find(".tmpl-dialog-module-settings").hide(),b("#"+d.tmpl).show(),"undefined"==typeof d.options.dialog_options.title&&"sedDialogSettings"!=d.id&&b(d.selector).dialog("option","title",b("#"+d.tmpl).attr("data-dialog-title"))),b(d.selector).dialog("open");var f=b.extend({},d.extra||{});c.Events.trigger(d.id,[d.data],f,d)};c.Events.bind("element_open_dialog",function(a){d(a)}),c.previewer.bind("element_open_dialog",function(a){d(a)})}})}(sedApp,jQuery),function(a,b){var c=sedApp.editor;c.sedAppLoadedScripts=c.sedAppLoadedScripts||[],c.designEditorTpls=c.designEditorTpls||{},c.SiteEditorDialogSettings=c.Class.extend({initialize:function(a){b.extend(this,a||{}),this.templateType="html",this.settingsType="module",this.dialogsContents={},this.dialogsTitles={},this.ajaxProcessing={},this.ajaxResetTmpls={},this.ajaxCachTmpls={},this.ajaxCachControls={},this.backgroundAjaxload={},this.optionsGroup="",this.needToRefreshGroups=[],this.loading={},this.currentSettingsId="",this.pageOptionsLoaded=[],this.dialogSelector="#sed-dialog-settings",this.rootBackBtn={},this._dialogInit(),this.ready()},_dialogInit:function(){var a=this,d=this.dialogSelector;b(d).dialog({autoOpen:!1,modal:!1,resizable:!1,width:295,height:600,position:{my:"right-20",at:"right",of:"#sed-site-preview"},open:function(){a._switchTmpl()},close:function(){c.previewer.send("isOpenDialogSettings",!1),a._resetTmpl()}}),this._initDialogMultiLevelBox(d),this._initDialogScrollBar(d),b(".accordion-panel-settings").livequery(function(){(_.isUndefined(b(this).data("acInit"))||b(this).data("acInit")!==!0)&&b(this).accordion({active:!1,collapsible:!0,event:"click",heightStyle:"content",create:function(a,d){b(this).data("acInit",!0),c.Events.trigger("accordionPanelSettingsInit",a,d,b(this))}})})},ready:function(){var a=this;b(this.dialogSelector).find(".open-new-group-settings").livequery(function(){b(this).on("click.openNewGroup",function(){if(a.rootBackBtn[b(this).data("settingsId")]={prevSettingsId:a.currentSettingsId,prevSettingsType:a.settingsType},"module"==b(this).data("settingsType")){var d,e=b.extend({},b(this).data("sedDialog")||{},{shortcodeName:b(this).data("settingsId")});if(_.isUndefined(b(this).data("modelId")))return;d=b(this).data("modelId");var f={selector:b(this).data("settingsId"),forceOpen:!0,reset:!0,data:e,extra:{attrs:c.sedShortcode.getAttrs(d,!0)}};c.currentTargetElementId=d,c.previewer.send("current_element",c.currentTargetElementId),c.appModulesSettings.openInitDialogSettings(f,!0)}else c.appSettings.openInitDialogSettings(b(this).data("settingsId"),!0,!0)})},function(){b(this).unbind("click.openNewGroup")}),c.Events.bind("afterAppendSettingsTmpl",function(c,d,e){if(!_.isUndefined(a.rootBackBtn[e])){var f='<span id="sed_root_back_settings_btn" class="icon-close-level-box"><i class="icon-chevron-left"></i></span>',g=b(f).prependTo(b(a.dialogSelector).siblings(".ui-dialog-titlebar:first").find("[data-self-level-box='dialog-level-box-settings-"+e+"-container']"));g.data("settingsId",a.rootBackBtn[e].prevSettingsId),g.data("settingsType",a.rootBackBtn[e].prevSettingsType),delete a.rootBackBtn[e]}}),c.Events.bind("endInitAppendSettingsTmpl",function(c,d,e){if(!_.isUndefined(a.rootBackBtn[e])){var f='<span id="sed_root_back_settings_btn" class="icon-close-level-box"><i class="icon-chevron-left"></i></span>',g=b(f).prependTo(b(a.dialogSelector).siblings(".ui-dialog-titlebar:first").find("[data-self-level-box='dialog-level-box-settings-"+e+"-container']"));g.data("settingsId",a.rootBackBtn[e].prevSettingsId),g.data("settingsType",a.rootBackBtn[e].prevSettingsType),delete a.rootBackBtn[e]}}),b("#sed_root_back_settings_btn").livequery(function(){b(this).click(function(){"module"==b(this).data("settingsType")?c.previewer.send("go_back_to_main_module",c.currentTargetElementId):c.appSettings.openInitDialogSettings(b(this).data("settingsId"),!0,!1)})},function(){b(this).unbind("click")}),c.Events.bind("moduleDragStartEvent",function(d){var e;b.each(c.shortcodes,function(a,b){if(b.asModule&&b.moduleName==d)return e=a,!1}),e&&_.isUndefined(c.settings.groups[e])&&_.isUndefined(a.backgroundAjaxload[e])&&_.isUndefined(a.dialogsContents[e])&&(a._sendRequest(e,"module",e),a.backgroundAjaxload[e]=1)}),c.Events.bind("afterResetpageInfoSettings",function(){if(_.isEmpty(a.needToRefreshGroups)||(console.log("----------self.needToRefreshGroups------------",a.needToRefreshGroups),_.each(a.needToRefreshGroups,function(d){var e=d+"_"+c.settings.page.id,f=b(a.dialogSelector).dialog("isOpen"),g="sed_page_options"==d&&b.inArray(e,a.pageOptionsLoaded)>-1;console.log("----------self.backgroundAjaxload[settingId]------------",a.backgroundAjaxload[e]),console.log("----------self.dialogsContents[settingId]------------",a.dialogsContents[e]),console.log("----------needToRefreshGroups ## settingId------------",e),_.isUndefined(a.backgroundAjaxload[e])&&_.isUndefined(a.dialogsContents[e])&&!g?f&&a.optionsGroup==d?(a._resetTmpl(),a.currentSettingsId=e,a._addLoading(),a._sendRequest(e,"app",d)):(a._sendRequest(e,"app",d),a.backgroundAjaxload[e]=1):_.isUndefined(a.dialogsContents[e])||f&&a.optionsGroup==d&&(a._resetTmpl(),a.currentSettingsId=e,a._switchTmpl())})),"post"==c.settings.page.type){var d="sed_post_options_",e=d+c.settings.page.id,f=e,g=b(a.dialogSelector).dialog("isOpen");_.isUndefined(c.settings.groups[f])&&(b(".sed_customize_post_settings_btn").data("settingId",e),b(".sed-customize-post-settings").show(),_.isUndefined(a.backgroundAjaxload[e])&&_.isUndefined(a.dialogsContents[e])?g&&0===a.optionsGroup.indexOf(d)?(a._resetTmpl(),a.currentSettingsId=e,a._addLoading(),a._sendRequest(e,"app",f)):(a._sendRequest(e,"app",f),a.backgroundAjaxload[e]=1):_.isUndefined(a.dialogsContents[e])||g&&0===a.optionsGroup.indexOf(d)&&(a._resetTmpl(),a.currentSettingsId=e,a._switchTmpl()))}else b(a.dialogSelector).dialog("isOpen")&&0===a.optionsGroup.indexOf("sed_post_options_")&&b(a.dialogSelector).dialog("close"),b(".sed-customize-post-settings").hide()})},_initDialogMultiLevelBox:function(a){b(a).multiLevelBoxPlugin({titleBar:b(a).siblings(".ui-dialog-titlebar:first"),innerContainer:b(a).find(".dialog-level-box-settings-container")}),b(a).siblings(".ui-dialog-titlebar:first").find(".close-page-box").livequery(function(){b(this).click(function(c){b(a).dialog("close")})})},_initDialogScrollBar:function(a){var c=this;b(a).find('[data-multi-level-box="true"]').livequery(function(){_.isUndefined(c.dialogsContents[c.currentSettingsId])&&b(this).mCustomScrollbar({advanced:{updateOnBrowserResize:!0,updateOnContentResize:!0},scrollButtons:{enable:!0},callbacks:{onOverflowY:function(){b(this).find(".mCSB_container").addClass("mCSB_ctn_margin")},onTotalScrollOffset:120,onOverflowYNone:function(){b(this).find(".mCSB_container").removeClass("mCSB_ctn_margin")}}})})},_switchTmpl:function(a){var d=this,e=this.dialogSelector;if(a=!!_.isUndefined(a)||a,_.isUndefined(d.dialogsContents[d.currentSettingsId])){if("ajax"==this.templateType)this._ajaxLoadSettings();else if("html"==this.templateType){var f=b(b("#sed-tmpl-dialog-settings-"+d.currentSettingsId).html()).appendTo(b(e)).fadeIn("slow");c.Events.trigger("afterInitAppendSettingsTmpl",f,this.settingsType,this.currentSettingsId),b(e).data("sed.multiLevelBoxPlugin").options.innerContainer=b(e).find(".dialog-level-box-settings-container"),b(e).data("sed.multiLevelBoxPlugin")._render(),c.Events.trigger("endInitAppendSettingsTmpl",f,this.settingsType,this.currentSettingsId)}}else{var f=d.dialogsContents[d.currentSettingsId].appendTo(b(e)).fadeIn("slow");d.dialogsTitles[d.currentSettingsId].appendTo(b(e).siblings(".ui-dialog-titlebar:first")),c.Events.trigger("afterAppendSettingsTmpl",f,this.settingsType,this.currentSettingsId),a===!0&&b(e).data("sed.multiLevelBoxPlugin")._reset()}},_resetTmpl:function(){var a=this,d=this.dialogSelector;return b("#sed_root_back_settings_btn").remove(),_.isUndefined(this.ajaxProcessing[a.currentSettingsId])?(c.Events.trigger("beforeResetSettingsTmpl",a.currentSettingsId,this.settingsType),a.dialogsTitles[a.currentSettingsId]=b(d).siblings(".ui-dialog-titlebar:first").children(".multi-level-box-title").detach(),a.dialogsContents[a.currentSettingsId]=b(d).children().hide().detach(),void c.Events.trigger("afterResetSettingsTmpl",a.currentSettingsId,this.settingsType)):void(this.ajaxResetTmpls[a.currentSettingsId]="yes")},_ajaxLoadSettings:function(){var a=this,d=this.dialogSelector;if(!_.isUndefined(a.ajaxResetTmpls[a.currentSettingsId]))return void delete a.ajaxResetTmpls[a.currentSettingsId];if(!_.isUndefined(a.ajaxCachTmpls[a.currentSettingsId])){var e=a.ajaxCachTmpls[a.currentSettingsId],f=b(e).appendTo(b(d));c.Events.trigger("afterInitAppendSettingsTmpl",f,a.settingsType,a.currentSettingsId),b(d).data("sed.multiLevelBoxPlugin").options.innerContainer=b(d).find(".dialog-level-box-settings-container"),b(d).data("sed.multiLevelBoxPlugin")._render(),delete a.ajaxCachTmpls[a.currentSettingsId];var g=b.extend(!0,{},a.ajaxCachControls[a.currentSettingsId]);return a.setControls(g,a.currentSettingsId,a.settingsType),c.Events.trigger("endInitAppendSettingsTmpl",f,a.settingsType,a.currentSettingsId),void delete a.ajaxCachControls[a.currentSettingsId]}return this._addLoading(),_.isUndefined(this.backgroundAjaxload[this.currentSettingsId])?void this._sendRequest(this.currentSettingsId,this.settingsType,this.optionsGroup):void delete this.backgroundAjaxload[this.currentSettingsId]},_addLoading:function(){if(_.isUndefined(this.loading[this.currentSettingsId])){var a,d=c.template("sed-ajax-loading");a=d({type:"medium"}),this.loading[this.currentSettingsId]=b(a).appendTo(b(this.dialogSelector)),this.loading[this.currentSettingsId].show()}},_sendRequest:function(a,d,e){var f=this,g=this.dialogSelector;this.ajaxProcessing[a]=1;var h={action:"sed_load_options",setting_id:a,setting_type:d,options_group:e,nonce:c.settings.nonce.options.load,sed_page_ajax:"sed_options_loader"};h=c.applyFilters("sedAjaxLoadOptionsDataFilter",h);c.wpAjax.send({type:"POST",data:h,success:function(a){var d=a.output,e=a.controls,h=a.relations,i=a.settings,j=a.panels,k=a.settingId,l=a.settingType,m=a.groups,n=a.designTemplate,o=a.partials,p=a.previewParams;if(delete f.ajaxProcessing[k],_.isUndefined(f.loading[k])||(f.loading[k].hide(),f.loading[k].remove(),delete f.loading[k]),f.setDependencies(h,k),f.setSettings(i,k),f.setGroups(m,k),f.setPanels(j,k),f.sedDesignTemplate(n,k),f.setDynamicPartials(o,k),f.setPreviewParams(p,k),_.isUndefined(f.ajaxResetTmpls[k])&&_.isUndefined(f.backgroundAjaxload[k])){var q=b(d).appendTo(b(g));c.Events.trigger("afterInitAppendSettingsTmpl",q,l,k),b(g).data("sed.multiLevelBoxPlugin").options.innerContainer=b(g).find(".dialog-level-box-settings-container"),b(g).data("sed.multiLevelBoxPlugin")._render(),f.setControls(e,k,l),c.Events.trigger("endInitAppendSettingsTmpl",q,l,k)}else f.ajaxCachTmpls[k]=d,f.ajaxCachControls[k]=e,_.isUndefined(f.ajaxResetTmpls[k])||delete f.ajaxResetTmpls[k],_.isUndefined(f.backgroundAjaxload[k])||delete f.backgroundAjaxload[k]},error:function(a){var d=a.settingId;_.isUndefined(f.loading[d])||(f.loading[d].hide(),f.loading[d].remove(),delete f.loading[d]),_.isUndefined(f.ajaxResetTmpls[d])||delete f.ajaxResetTmpls[d],_.isUndefined(f.backgroundAjaxload[d])||delete f.backgroundAjaxload[d],delete f.ajaxProcessing[d];var e,h=c.template("sed-load-options-errors");e=h({message:a.message}),b(e).appendTo(b(f.dialogSelector)),b(g).data("sed.multiLevelBoxPlugin").options.innerContainer=b(g).find(".dialog-level-box-settings-container"),b(g).data("sed.multiLevelBoxPlugin")._render()}})},setDependencies:function(a,d){if(!_.isUndefined(a)&&!_.isEmpty(a)&&_.isObject(a)){var e={};e[d]=a,c.settingsRelations=b.extend(c.settingsRelations,e)}},sedDesignTemplate:function(a,b){_.isUndefined(a)||_.isEmpty(a)||(c.designEditorTpls[b]=a)},setSettings:function(a,d){if(!_.isEmpty(a)){var e={};_.each(a,function(a,b){if(!c.has(b)){c.create(b,b,a.value,{transport:a.transport||"refresh",previewer:c.previewer,stype:a.type||"general",dirty:a.dirty});c.settings.settings[b]=a,e[b]=a.value}}),c.previewer.send("settings",e),b.each(a,function(a,d){if(b.inArray(a,_.keys(e))==-1)return!0;if(d.dirty){var f=c(a);f.callbacks.fireWith(f,[f.get(),{}])}})}},setDynamicPartials:function(a){c.previewer.send("addDynamicPartials",a)},setPreviewParams:function(a,b){c.previewer.send("addDynamicPreviewParams",a)},setPanels:function(a,b){_.isUndefined(c.settingsPanels[b])&&(c.settingsPanels[b]={}),_.each(a,function(a,d){c.settingsPanels[b][d]=a})},setControls:function(a,d,e){_.isEmpty(a)||(_.isUndefined(c.sedGroupControls[d])&&(c.sedGroupControls[d]=[]),"module"==e?(_.each(a,function(a,b){c.sedGroupControls[d].push(a)}),_.isUndefined(c.appModulesSettings.sedDialog.data.panelId)?c.appModulesSettings.initSettings():c.appModulesSettings.initSettings(c.appModulesSettings.sedDialog.data.panelId)):(_.each(a,function(a,e){b.inArray(e,_.keys(c.settings.controls))==-1&&(c.settings.controls[e]=a,c.Events.trigger("renderSettingsControls",e,a)),c.sedGroupControls[d].push(a)}),c.Events.trigger("after_app_settings_update",d),c.Events.trigger("after_group_settings_update",d)))},setGroups:function(a,d){var e=this;_.isEmpty(a)||_.each(a,function(a,f){"sed_page_options"==f&&b.inArray(d,e.pageOptionsLoaded)==-1&&e.pageOptionsLoaded.push(d),b.inArray(f,_.keys(c.settings.groups))==-1&&(c.settings.groups[f]=a),a.pages_dependency&&b.inArray(f,e.needToRefreshGroups)==-1&&e.needToRefreshGroups.push(f)})},openInitDialogSettings:function(a,d,e,f,g,h){var i=b(this.dialogSelector).dialog("isOpen");if(d=!!_.isUndefined(d)||d,i||d!==!0){if(!i)return;this._resetTmpl(),this.optionsGroup=h,this.templateType=g,this.settingsType=f,this.currentSettingsId=a,e=!!_.isUndefined(e)||e,this._switchTmpl(e)}else this.currentSettingsId=a,this.optionsGroup=h,this.templateType=g,this.settingsType=f,b(this.dialogSelector).dialog("open"),c.previewer.send("isOpenDialogSettings",!0)}}),c.AppModulesSettings=c.Class.extend({initialize:function(a){b.extend(this,a||{}),this.currentDialogSelector="none",this.sedDialog,this.forceUpdate=!1,this.rowContainerSettingsData={},this.panelsNeedToUpdate=[],this.dialogSelector="#sed-dialog-settings",this.ready()},ready:function(){var a=this;this.initDialogSettings(),c.previewer.bind("openDialogSettings",function(b){a.openInitDialogSettings(b)}),c.previewer.bind("rowContainerSettingData",function(b){a.rowContainerSettingsData=b}),c.previewer.bind("currentModuleSelected",function(b){a.moduleSelect(b)}),c.previewer.bind("changeCurrentElementBySkinChange",function(b){a.updateByChangePattern(b)}),c.previewer.bind("shortcodeControlsUpdate",function(b){a.shortcodeControlsUpdate(b)}),c.previewer.bind("currentElementId",function(a){c.currentTargetElementId=a}),c.previewer.bind("currentPostId",function(a){c.currentPostId=a}),this.readySettingsType()},readySettingsType:function(){var a=this;c.Events.bind("animationSettingsType",function(c,d){b(a.dialogSelector).data("sed.multiLevelBoxPlugin")._callDirectlyLevelBox("dialog_page_box_"+c.shortcodeName+"_animation")}),c.Events.bind("changeSkinSettingsType",function(d,e){b(a.dialogSelector).data("sed.multiLevelBoxPlugin")._callDirectlyLevelBox("dialog_page_box_"+d.shortcodeName+"_skin"),c.Events.trigger("loadSkinsDirectly",d.moduleName)}),c.Events.bind("linkToSettingsType",function(c,d){b(a.dialogSelector).data("sed.multiLevelBoxPlugin")._callDirectlyLevelBox(c.shortcodeName+"_link_to_panel_level_box")}),c.Events.bind("afterAppendSettingsTmpl",function(b,d,e){"module"==d&&c.Events.trigger("afterAppendModulesSettingsTmpl",a,b)}),c.Events.bind("afterInitAppendSettingsTmpl",function(b,d,e){"module"==d&&c.Events.trigger("afterInitAppendModulesSettingsTmpl",a,b)}),c.Events.bind("endInitAppendSettingsTmpl",function(c,d,e){if("module"==d&&"sed_row"==a.sedDialog.data.shortcodeName){var f='<span id="row_back_settings_element" class="icon-close-level-box"><i class="icon-chevron-left"></i></span>';b(a.dialogSelector).siblings(".ui-dialog-titlebar:first").find("[data-self-level-box='dialog-level-box-settings-sed_row-container']").prepend(b(f))}}),c.Events.bind("beforeResetSettingsTmpl",function(a,b){"module"==b&&c.Events.trigger("beforeResetDialogSettingsTmpl",a)})},initDialogSettings:function(){var a=this,d=a.dialogSelector;c.Events.bind("beforerCreateSettingsControls",function(a,d,e){if(!_.isUndefined(d)&&!_.isUndefined(d.is_image_size)){var f="sed_pb_"+a,g="";!_.isUndefined(d.has_custom_size)&&d.has_custom_size&&(g+='<option value="" > '+c.I18n.custom_size+" </option>"),_.each(c.addOnSettings.imageModule.sizes,function(a,b){var c=_.isUndefined(a.width)?"":a.width,d=_.isUndefined(a.height)?"":a.height;g+='<option value="'+b+'" > '+a.label+" - "+c+" x "+d+" </option>"}),b("#"+f).html(g)}}),b(d).find(".go-panel-element-update").livequery(function(){_.isUndefined(c.sedDialogSettings.dialogsContents[a.currentSettingsId])&&b(this).click(function(){var c=b(this).data("panelId");c&&b.inArray(c,a.panelsNeedToUpdate)==-1&&(a.initSettings(c),a.panelsNeedToUpdate.push(c))})}),b(d).find(".go-row-container-settings").livequery(function(){_.isUndefined(c.sedDialogSettings.dialogsContents[a.currentSettingsId])&&b(this).click(function(){a.lastTargetElementId=_.clone(c.currentTargetElementId),c.currentTargetElementId=a.rowContainerSettingsData.rowId,c.previewer.send("current_element",c.currentTargetElementId),a.openInitDialogSettings(a.rowContainerSettingsData)})}),b("#row_back_settings_element").livequery(function(){_.isUndefined(c.sedDialogSettings.dialogsContents[a.currentSettingsId])&&b(this).click(function(){c.currentTargetElementId=a.lastTargetElementId,c.previewer.send("go_back_to_main_module",c.currentTargetElementId)})}),b(a.dialogSelector).siblings(".ui-dialog-titlebar:first").find("[data-self-level-box] >.icon-close-level-box").livequery(function(){_.isUndefined(c.sedDialogSettings.dialogsContents[a.currentSettingsId])&&b(this).click(function(){_.isUndefined(a.sedDialog)||b(this).parent().data("selfLevelBox")!="dialog_page_box_"+a.sedDialog.data.shortcodeName+"_design_panel"||a.forceUpdate!==!0||(a.initSettings(),a.forceUpdate=!1)})}),c.previewer.bind("dialogSettingsClose",function(){var c=b(a.dialogSelector).dialog("isOpen");c&&b(a.dialogSelector).dialog("close")})},updateSettings:function(a,d,e,f,g){if(b.inArray(a,_.keys(c.settings.controls))==-1){c.settings.controls[a]=d,c.Events.trigger("renderSettingsControls",a,d,f);var h=c.control.instance(a);b(h.container).parents(".row_settings:first").show()}else{var h=c.control.instance(a);b(h.container).parents(".row_settings:first").show(),_.isUndefined(f.attrs)?h.update():h.update(f.attrs)}if(!_.isUndefined(g)&&g===!0)return h},postButtonIdUpdate:function(a){if(!_.isUndefined(a.contextmenuPostId)){var c=b(this.dialogSelector).find(".sed_post_edit_button");c.length>0&&c.data("postId",a.contextmenuPostId)}},widgetButtonIdUpdate:function(a){if(!_.isUndefined(a.contextmenuWidgetIdBase)){var c=a.contextmenuWidgetIdBase,d=b("#widget-tpl-"+c).data("widgetTitle");b(this.dialogSelector).siblings(".ui-dialog-titlebar:first").find('[data-self-level-box="dialog-level-box-settings-sed_widget-container"] >.ui-dialog-title').text(d);var e=b(this.dialogSelector).find(".sed_widget_button");e.length>0&&e.data("widgetIdBase",c)}},getSettings:function(a){var d=this.sedDialog.data;return!_.isUndefined(a)&&a&&"root"!=a?_.filter(c.sedGroupControls[d.shortcodeName],function(b){if(!_.isUndefined(b.shortcode)&&"sed_widget"==b.shortcode&&!_.isUndefined(b.attr_name)&&"instance"==b.attr_name)return!1;if(_.isUndefined(b.panel)||_.isUndefined(c.settingsPanels[d.shortcodeName])||_.isUndefined(c.settingsPanels[d.shortcodeName][b.panel]))return!1;var e=c.settingsPanels[d.shortcodeName][b.panel];return e.id==a}):_.filter(c.sedGroupControls[d.shortcodeName],function(a){if(!_.isUndefined(a.shortcode)&&"sed_widget"==a.shortcode&&!_.isUndefined(a.attr_name)&&"instance"==a.attr_name)return!1;if(_.isUndefined(a.panel)||_.isUndefined(c.settingsPanels[d.shortcodeName])||_.isUndefined(c.settingsPanels[d.shortcodeName][a.panel]))return!0;var e=c.settingsPanels[d.shortcodeName][a.panel];return b.inArray(e.type,["inner_box"])==-1})},initSettings:function(a){if(!_.isUndefined(this.sedDialog)){var d,e=this,f=this.sedDialog.data,g=b.extend({},this.sedDialog.extra||{});d=_.isUndefined(a)?this.getSettings():this.getSettings(a),_.each(d,function(a){e.updateSettings(a.control_id,a,f.shortcodeName,g)}),this.forceUpdate!==!0&&(this.postButtonIdUpdate(f),this.widgetButtonIdUpdate(f),_.isUndefined(f.settingsType)||c.Events.trigger(f.settingsType+"SettingsType",f,g),c.Events.trigger("after_shortcode_update_setting",f.shortcodeName),c.Events.trigger("after_group_settings_update",f.shortcodeName),c.Events.trigger(f.shortcodeName+"_dialog_settings",g.attrs||{}))}},openInitDialogSettings:function(a,b){this.sedDialog=a,this.currentSettingsId=a.selector,this.panelsNeedToUpdate=[];var d=!!_.isUndefined(a.reset)||a.reset,e=!_.isUndefined(c.sedGroupControls[this.currentSettingsId]);c.sedDialogSettings.openInitDialogSettings(this.currentSettingsId,b,d,"module","ajax",this.currentSettingsId),e&&(_.isUndefined(a.data.panelId)?this.initSettings():this.initSettings(a.data.panelId))},moduleSelect:function(a){var b=!_.isUndefined(a.forceOpen)&&a.forceOpen===!0;this.openInitDialogSettings(a,b)},updateByChangePattern:function(a){var b=this;_.each(c.sedGroupControls[a.shortcode_name],function(d){if(!_.isUndefined(d.attr_name)){var e=a.shortcode_name+"_"+d.attr_name;c.previewer.trigger("currentElementId",a.elementId),b.updateSettings(e,d,a.shortcode_name,{attrs:a.attrs})}}),c.Events.trigger("after_shortcode_update_setting",a.shortcode_name),c.Events.trigger(a.shortcode_name+"_dialog_settings",a.attrs||{})},shortcodeControlsUpdate:function(a){var d=this,e=a.shortcode,f=a.attrs,g=a.targetAttrs||[];_.each(c.sedGroupControls[e],function(a){b.isArray(g)&&0!=g.length&&b.inArray(a.attr_name,g)==-1||d.updateSettings(e+"_"+a.attr_name,a,e,{attrs:f})})}}),b(function(){c.sedDialogSettings=new c.SiteEditorDialogSettings({}),c.appModulesSettings=new c.AppModulesSettings({})})}(sedApp,jQuery),function(a,b){var c=sedApp.editor;c.postsContent=c.postsContent||{},b(function(){var a=b(document.body);b.extend(c.previewer,{save:function(){c.Events.trigger("beforeSave");var d={};c.each(function(a,b){a._dirty&&(d[b]=a())});var e,f,g=this,h={action:"customize_save",sed_app_editor:"save",theme:c.settings.theme.stylesheet,sed_page_customized:JSON.stringify(d),sed_posts_content:JSON.stringify(c.postsContent||{}),nonce:this.nonce.save},i=c.state("processing");a.addClass("saving"),b("#save").find("span.el_txt").text(c.l10n.saving),f=function(){h=c.applyFilters("sedSaveQueryFilter",h);var d=b.post(SEDAJAX.url,h);c.trigger("save",d),d.always(function(){a.removeClass("saving")}),d.done(function(a){return"0"===a?(g.preview.iframe.hide(),void g.login().done(function(){g.save(),g.preview.iframe.show()})):"-1"===a?void g.cheatin():(c.each(function(a){a._dirty=!1}),c.previewer.send("saved",a),void c.trigger("saved",a))})},0===i()?f():(e=function(){0===i()&&(c.state.unbind("change",e),f())},c.state.bind("change",e))}}),function(){var a=new c.Values,d=a.create("saved"),e=a.create("processing");a.bind("change",function(){var a=b("#save");d()?(a.prop("disabled",!0),a.find("span.el_txt").text(c.l10n.saved)):(a.prop("disabled",!1),a.find("span.el_txt").text(c.l10n.save))}),d(!0),e(0),c.bind("change",function(){a("saved").set(!1)}),c.bind("saved",function(){a("saved").set(!0)}),c.state=a}(),b("#save").click(function(a){c.previewer.save(),a.preventDefault()}).keydown(function(a){9!==a.which&&(13===a.which&&c.previewer.save(),a.preventDefault())}),b(window).on("beforeunload",function(){if(!c.state("saved")())return c.l10n.saveAlert})})}(sedApp,jQuery),function(a,b){var c=sedApp.editor;b(function(){b.each(c.settings.settings,function(a,b){c.create(a,a,b.value,{transport:b.transport,previewer:c.previewer,stype:b.type||"general",dirty:!!b.dirty})}),console.log("---------------api.settings-----------",c.settings),c.styleEditorSettings=c.styleEditorSettings||[],b.each(c.settings.settings,function(a,b){_.isUndefined(b.type)||"style-editor"!=b.type||c.styleEditorSettings.push(a)}),c.Events.bind("renderSettingsControls",function(a,b,d){c.Events.trigger("beforerCreateSettingsControls",a,b,d);var e,f=c.controlConstructor[b.type]||c.Control;e=c.control.add(a,new f(a,{params:b,previewer:c.previewer,mediaSettings:c.mediaSettings,extraOpt:d||{}}))});var a=_.map(c.settings.controls,function(a,b){var c=_.clone(a);return c.control_id=b,c}),d=_.filter(a,function(a,b){return!_.isUndefined(a.sub_category)&&a.sub_category});c.sedGroupControls=_.groupBy(d,function(a,b){return a.sub_category});var e=_.filter(c.settings.controls,function(a,b){return!_.isUndefined(a.category)&&"style-editor"==a.category});c.stylesSettingsControls=_.groupBy(e,function(a,b){return a.option_group});new Date;b.each(c.settings.controls,function(a,d){(_.isUndefined(d.category)||b.inArray(d.category,["module-settings","style-editor","layout"])==-1||!_.isUndefined(d.sub_category)&&"general_settings"==d.sub_category&&"style-editor"==d.category)&&c.Events.trigger("renderSettingsControls",a,d)});new c.Ajax({url:SED_BASE_URL+"extensions/pagebuilder/includes/ajax_shortcode_pattern.php",data:{action:"shortcodes_default_pattern",sed_page_ajax:"sed_ajax_default_patterns"},loadingType:"small",success:function(){var a=this.response.data.output;c.previewer.bind("previewerActive",function(){b.extend(c.defaultPatterns,a||{});var d=c.applyFilters("sedDefaultPatternsFilter",b.extend(!0,{},c.defaultPatterns));c.previewer.send("defaultModulePatterns",d)})},error:function(){}},{container:"body",repeatRequest:!1});c.previewer.previewUrl()?c.previewer.refresh():c.previewer.previewUrl(c.settings.url.home),c.trigger("ready")})}(sedApp,jQuery);