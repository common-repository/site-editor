+function(a){"use strict";var b=function(b,c){this.$element=a(b),this.options=a.extend({},{titleBar:"",innerContainer:""},c),0!=this.options.innerContainer.length&&this._render()};b.prototype={_activeTransition:function(){this.$element.find("[data-multi-level-box=true]").removeClass("level-box-transition-none"),this.options.titleBar.find(".multi-level-box-title").removeClass("level-box-transition-none")},_render:function(){this._PageBoxItems(),this._PageBoxItems2()},_PageBoxItems:function(){var b=this,c=b.$element.find("[data-multi-level-box=true]"),d=b.options.innerContainer.attr("id"),e=b.options.innerContainer.data("title"),f=' <div class="multi-level-box-title first multi-level-box-current" data-self-level-box="'+d+'"><span class="ui-dialog-title">'+e+'</span> <button class="close-page-box ui-button ui-dialog-titlebar-close"><span class="icon-delete"></span><span class="ui-button-text">close</span></button><div> ';c.addClass("multi-level-box"),b.options.innerContainer.attr("data-multi-level-box","true"),b.options.innerContainer.attr("data-level","0"),b.options.innerContainer.addClass("multi-level-box-current multi-level-box"),b.options.titleBar.append(f),b.options.titleBar.find(".ui-dialog-title:first").css("visibility","hidden"),b.options.titleBar.find(".ui-dialog-titlebar-close:first").css("visibility","hidden"),c.each(function(c){var d=a(this),e=d.attr("id"),f=d.parentsUntil(b.$element,"[data-multi-level-box=true]:first").attr("id"),g=d.parentsUntil(b.$element,"[data-multi-level-box=true]").length,h=d.data("title"),i=' <div class="multi-level-box-title  multi-level-box-next" data-self-level-box="'+e+'" ><span class="icon-close-level-box"><i class="icon-chevron-left"></i></span><span class="ui-dialog-title">'+h+'</span> <button class="close-page-box ui-button ui-dialog-titlebar-close"><span class="icon-delete"></span><span class="ui-button-text">close</span></button><div> ';d.data("backLevelBoxId",f),_.isUndefined(d.data("level"))&&d.data("level",g),d.addClass("multi-level-box-next"),b.options.titleBar.append(i)})},_pageBoxNext:function(b){var c=this;c._activeTransition();var d=a(b).data("relatedLevelBox"),e=a(b).parentsUntil(c.$element,"[data-multi-level-box=true]:first"),f=e.attr("id"),g=c.$element.find("#"+d);e.removeClass("multi-level-box-current"),e.addClass("multi-level-box-prev"),g.removeClass("multi-level-box-next"),g.addClass("multi-level-box-current");var h=c.options.titleBar.find("[data-self-level-box="+d+"]"),i=c.options.titleBar.find("[data-self-level-box="+f+"]");i.removeClass("multi-level-box-current"),i.addClass("multi-level-box-prev"),h.removeClass("multi-level-box-next"),h.addClass("multi-level-box-current"),e.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){a(this).data("level")==g.data("level")&&(a(this).addClass("level-box-transition-none"),i.addClass("level-box-transition-none"),a(this).removeClass("multi-level-box-prev"),a(this).addClass("multi-level-box-next"),i.removeClass("multi-level-box-prev"),i.addClass("multi-level-box-next"),a(this).removeClass("level-box-transition-none"),i.removeClass("level-box-transition-none"))})},_PageBoxItems2:function(){var b=this;b.$element.append(b.$element.find("[data-multi-level-box=true]"));var c=b.$element.find("[data-related-level-box]"),d=b.options.titleBar.find("[data-self-level-box] .icon-close-level-box");b.$element.find("[data-multi-level-box=true]");c.filter("form").submit(function(a){b._pageBoxNext(this)}),c.not("form").click(function(a){b._pageBoxNext(this)}),d.click(function(c){b._activeTransition();var d=a(this).parent("[data-self-level-box]").data("selfLevelBox"),e=b.$element.find("#"+d),f=a("#"+d).data("backLevelBoxId"),g=a("#"+f);0!==e.data("level")&&(e.removeClass("multi-level-box-current"),e.addClass("multi-level-box-next")),g.removeClass("multi-level-box-prev"),g.addClass("multi-level-box-current");var h=b.options.titleBar.find("[data-self-level-box="+f+"]"),i=b.options.titleBar.find("[data-self-level-box="+d+"]");0!==e.data("level")&&(i.removeClass("multi-level-box-current"),i.addClass("multi-level-box-next")),h.removeClass("multi-level-box-prev"),h.addClass("multi-level-box-current")})},_reset:function(){var b=this,c=b.$element.find("[data-multi-level-box=true]"),d=b.options.titleBar.find(".multi-level-box-title");c.addClass("level-box-transition-none"),d.addClass("level-box-transition-none"),c.each(function(b){0==a(this).data("level")?a(this).hasClass("multi-level-box-prev")&&(a(this).removeClass("multi-level-box-prev"),a(this).addClass("multi-level-box-current")):(a(this).hasClass("multi-level-box-current")&&(a(this).removeClass("multi-level-box-current"),a(this).addClass("multi-level-box-next")),a(this).hasClass("multi-level-box-prev")&&(a(this).removeClass("multi-level-box-prev"),a(this).addClass("multi-level-box-next")))}),d.each(function(b){var c=a(this).data("selfLevelBox"),d=a("#"+c).data("level");0==d?a(this).hasClass("multi-level-box-prev")&&(a(this).removeClass("multi-level-box-prev"),a(this).addClass("multi-level-box-current")):(a(this).hasClass("multi-level-box-current")&&(a(this).removeClass("multi-level-box-current"),a(this).addClass("multi-level-box-next")),a(this).hasClass("multi-level-box-prev")&&(a(this).removeClass("multi-level-box-prev"),a(this).addClass("multi-level-box-next")))})},_callDirectlyLevelBox:function(b,c){this.$element.find("[data-multi-level-box=true]").addClass("level-box-transition-none"),this.options.titleBar.find(".multi-level-box-title").addClass("level-box-transition-none");var d=this,e=b,f=a("#"+e),g=f.data("backLevelBoxId"),h=a("#"+g);0!==f.data("level")&&(f.removeClass("multi-level-box-next"),f.addClass("multi-level-box-current"));var i=d.options.titleBar.find("[data-self-level-box="+e+"]"),j=d.options.titleBar.find("[data-self-level-box="+g+"]");for(0!==f.data("level")&&(i.removeClass("multi-level-box-next"),i.addClass("multi-level-box-current"));g;){0==h.data("level")?(h.removeClass("multi-level-box-current"),h.addClass("multi-level-box-prev"),j.removeClass("multi-level-box-current"),j.addClass("multi-level-box-prev")):(h.removeClass("multi-level-box-next"),h.addClass("multi-level-box-prev"),j.removeClass("multi-level-box-next"),j.addClass("multi-level-box-prev"));var g=h.data("backLevelBoxId"),h=a("#"+g),j=d.options.titleBar.find("[data-self-level-box="+g+"]")}}},a.fn.multiLevelBoxPlugin=function(c){return this.each(function(){var d=a(this),e=d.data("sed.multiLevelBoxPlugin"),f="object"==typeof c&&c;e||d.data("sed.multiLevelBoxPlugin",e=new b(this,f))})}}(jQuery);